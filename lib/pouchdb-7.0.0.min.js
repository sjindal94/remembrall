var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(E){var l=0;return function(){return l<E.length?{done:!1,value:E[l++]}:{done:!0}}};$jscomp.arrayIterator=function(E){return{next:$jscomp.arrayIteratorImpl(E)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(E,l,y){E!=Array.prototype&&E!=Object.prototype&&(E[l]=y.value)};$jscomp.getGlobal=function(E){return"undefined"!=typeof window&&window===E?E:"undefined"!=typeof global&&null!=global?global:E};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(E,l){this.$jscomp$symbol$id_=E;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:l})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function E(y){if(this instanceof E)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(y||"")+"_"+l++,y)}var l=0;return E}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var E=$jscomp.global.Symbol.iterator;E||(E=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[E]&&$jscomp.defineProperty(Array.prototype,E,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var E=$jscomp.global.Symbol.asyncIterator;E||(E=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(E){$jscomp.initSymbolIterator();E={next:E};E[$jscomp.global.Symbol.iterator]=function(){return this};return E};
!function(E){"object"==typeof exports&&"undefined"!=typeof module?module.exports=E():"function"==typeof define&&define.amd?define([],E):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PouchDB=E()}(function(){return function m(l,y,N){function v(d,K){if(!y[d]){if(!l[d]){var u="function"==typeof require&&require;if(!K&&u)return u(d,!0);if(H)return H(d,!0);u=Error("Cannot find module '"+d+"'");throw u.code="MODULE_NOT_FOUND",u;}u=y[d]={exports:{}};
l[d][0].call(u.exports,function(m){return v(l[d][1][m]||m)},u,u.exports,m,l,y,N)}return y[d].exports}for(var H="function"==typeof require&&require,d=0;d<N.length;d++)v(N[d]);return v}({1:[function(l,y,N){y.exports=function(m){return function(){var v=arguments.length;if(v){for(var l=[],d=-1;++d<v;)l[d]=arguments[d];return m.call(this,l)}return m.call(this,[])}}},{}],2:[function(l,y,N){function m(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=x(null),this._eventsCount=
0);this._maxListeners=this._maxListeners||void 0}function v(g,e,k,h){var Q,n,d;if("function"!=typeof k)throw new TypeError('"listener" argument must be a function');if((n=g._events)?(n.newListener&&(g.emit("newListener",e,k.listener?k.listener:k),n=g._events),d=n[e]):(n=g._events=x(null),g._eventsCount=0),d){if("function"==typeof d?d=n[e]=h?[k,d]:[d,k]:h?d.unshift(k):d.push(k),!d.warned&&(Q=void 0===g._maxListeners?m.defaultMaxListeners:g._maxListeners)&&0<Q&&d.length>Q)d.warned=!0,k=Error("Possible EventEmitter memory leak detected. "+
d.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.'),k.name="MaxListenersExceededWarning",k.emitter=g,k.type=e,k.count=d.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",k.name,k.message)}else n[e]=k,++g._eventsCount;return g}function H(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);
case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var g=Array(arguments.length),e=0;e<g.length;++e)g[e]=arguments[e];this.listener.apply(this.target,g)}}function d(g,e,k){g={fired:!1,wrapFn:void 0,target:g,type:e,listener:k};e=C.call(H,g);return e.listener=k,g.wrapFn=e}function F(g,e,k){g=g._events;if(!g)return[];if(e=g[e])if("function"==typeof e)k=k?[e.listener||e]:[e];else if(k)for(k=
Array(e.length),g=0;g<k.length;++g)k[g]=e[g].listener||e[g];else k=u(e,e.length);else k=[];return k}function K(g){var e=this._events;if(e){g=e[g];if("function"==typeof g)return 1;if(g)return g.length}return 0}function u(g,e){for(var k=Array(e),h=0;h<e;++h)k[h]=g[h];return k}var x=Object.create||function(g){var e=function(){};return e.prototype=g,new e},r=Object.keys||function(g){var e=[],k;for(k in g)Object.prototype.hasOwnProperty.call(g,k)&&e.push(k);return k},C=Function.prototype.bind||function(g){var e=
this;return function(){return e.apply(g,arguments)}};((y.exports=m).EventEmitter=m).prototype._events=void 0;m.prototype._maxListeners=void 0;var n=10;try{l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0});var h=0===l.x}catch(g){h=!1}h?Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(g){if("number"!=typeof g||0>g||g!=g)throw new TypeError('"defaultMaxListeners" must be a positive number');n=g}}):m.defaultMaxListeners=n;m.prototype.setMaxListeners=
function(g){if("number"!=typeof g||0>g||isNaN(g))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=g,this};m.prototype.getMaxListeners=function(){return void 0===this._maxListeners?m.defaultMaxListeners:this._maxListeners};m.prototype.emit=function(g){var e,k,h;var n="error"===g;if(k=this._events)n=n&&null==k.error;else if(!n)return!1;if(n){if(1<arguments.length&&(e=arguments[1]),e instanceof Error)throw e;k=Error('Unhandled "error" event. ('+e+")");throw k.context=
e,k;}if(!(e=k[g]))return!1;var d="function"==typeof e;switch(k=arguments.length){case 1:!function(e,g,k){if(g)e.call(k);else{g=e.length;e=u(e,g);for(var h=0;h<g;++h)e[h].call(k)}}(e,d,this);break;case 2:!function(e,g,k,h){if(g)e.call(k,h);else{g=e.length;e=u(e,g);for(var Q=0;Q<g;++Q)e[Q].call(k,h)}}(e,d,this,arguments[1]);break;case 3:!function(e,g,k,h,Q){if(g)e.call(k,h,Q);else{g=e.length;e=u(e,g);for(var n=0;n<g;++n)e[n].call(k,h,Q)}}(e,d,this,arguments[1],arguments[2]);break;case 4:!function(e,
g,k,h,Q,n){if(g)e.call(k,h,Q,n);else{g=e.length;e=u(e,g);for(var d=0;d<g;++d)e[d].call(k,h,Q,n)}}(e,d,this,arguments[1],arguments[2],arguments[3]);break;default:n=Array(k-1);for(h=1;h<k;h++)n[h-1]=arguments[h];!function(e,g,k,h){if(g)e.apply(k,h);else{g=e.length;e=u(e,g);for(var Q=0;Q<g;++Q)e[Q].apply(k,h)}}(e,d,this,n)}return!0};m.prototype.on=m.prototype.addListener=function(g,e){return v(this,g,e,!1)};m.prototype.prependListener=function(g,e){return v(this,g,e,!0)};m.prototype.once=function(g,
e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(g,d(this,g,e)),this};m.prototype.prependOnceListener=function(g,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(g,d(this,g,e)),this};m.prototype.removeListener=function(g,e){var k,h,n;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(h=this._events)||!(k=h[g]))return this;if(k===e||k.listener===
e)0==--this._eventsCount?this._events=x(null):(delete h[g],h.removeListener&&this.emit("removeListener",g,k.listener||e));else if("function"!=typeof k){var d=-1;for(n=k.length-1;0<=n;n--)if(k[n]===e||k[n].listener===e){var m=k[n].listener;d=n;break}if(0>d)return this;if(0===d)k.shift();else{n=d+1;for(var v=k.length;n<v;d+=1,n+=1)k[d]=k[n];k.pop()}1===k.length&&(h[g]=k[0]);h.removeListener&&this.emit("removeListener",g,m||e)}return this};m.prototype.removeAllListeners=function(g){var e,k;if(!(k=this._events))return this;
if(!k.removeListener)return 0===arguments.length?(this._events=x(null),this._eventsCount=0):k[g]&&(0==--this._eventsCount?this._events=x(null):delete k[g]),this;if(0===arguments.length){var h=r(k);for(k=0;k<h.length;++k)"removeListener"!==(e=h[k])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=x(null),this._eventsCount=0,this}if("function"==typeof(e=k[g]))this.removeListener(g,e);else if(e)for(k=e.length-1;0<=k;k--)this.removeListener(g,e[k]);return this};
m.prototype.listeners=function(g){return F(this,g,!0)};m.prototype.rawListeners=function(g){return F(this,g,!1)};m.listenerCount=function(g,e){return"function"==typeof g.listenerCount?g.listenerCount(e):K.call(g,e)};m.prototype.listenerCount=K;m.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],3:[function(l,y,N){(function(m){function v(){var d;l=!0;for(var n=r.length;n;){var h=r;r=[];for(d=-1;++d<n;)h[d]();n=r.length}l=!1}var l,d=m.MutationObserver||
m.WebKitMutationObserver;if(d){var F=0;d=new d(v);var K=m.document.createTextNode("");d.observe(K,{characterData:!0});var u=function(){K.data=F=++F%2}}else if(m.setImmediate||void 0===m.MessageChannel)u="document"in m&&"onreadystatechange"in m.document.createElement("script")?function(){var d=m.document.createElement("script");d.onreadystatechange=function(){v();d.onreadystatechange=null;d.parentNode.removeChild(d);d=null};m.document.documentElement.appendChild(d)}:function(){setTimeout(v,0)};else{var x=
new m.MessageChannel;x.port1.onmessage=v;u=function(){x.port2.postMessage(0)}}var r=[];y.exports=function(d){1!==r.push(d)||l||u()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(l,y,N){"function"==typeof Object.create?y.exports=function(m,v){m.super_=v;m.prototype=Object.create(v.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}})}:y.exports=function(m,v){m.super_=v;var l=function(){};l.prototype=
v.prototype;m.prototype=new l;m.prototype.constructor=m}},{}],5:[function(l,y,N){function m(){throw Error("setTimeout has not been defined");}function v(){throw Error("clearTimeout has not been defined");}function H(e){if(x===setTimeout)return setTimeout(e,0);if((x===m||!x)&&setTimeout)return x=setTimeout,setTimeout(e,0);try{return x(e,0)}catch(k){try{return x.call(null,e,0)}catch(Q){return x.call(this,e,0)}}}function d(){h&&C&&(h=!1,C.length?n=C.concat(n):g=-1,n.length&&F())}function F(){if(!h){var e=
H(d);h=!0;for(var k=n.length;k;){C=n;for(n=[];++g<k;)C&&C[g].run();g=-1;k=n.length}C=null;h=!1;(function(e){if(r===clearTimeout)return clearTimeout(e);if((r===v||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(Ka){try{return r.call(null,e)}catch(I){return r.call(this,e)}}})(e)}}function K(e,g){this.fun=e;this.array=g}function u(){}l=y.exports={};try{var x="function"==typeof setTimeout?setTimeout:m}catch(e){x=m}try{var r="function"==typeof clearTimeout?clearTimeout:v}catch(e){r=
v}!0;var C,n=[],h=!1,g=-1;l.nextTick=function(e){var g=Array(arguments.length-1);if(1<arguments.length)for(var d=1;d<arguments.length;d++)g[d-1]=arguments[d];n.push(new K(e,g));1!==n.length||h||H(F)};K.prototype.run=function(){this.fun.apply(null,this.array)};l.title="browser";l.browser=!0;l.env={};l.argv=[];l.version="";l.versions={};l.on=u;l.addListener=u;l.once=u;l.off=u;l.removeListener=u;l.removeAllListeners=u;l.emit=u;l.prependListener=u;l.prependOnceListener=u;l.listeners=function(e){return[]};
l.binding=function(e){throw Error("process.binding is not supported");};l.cwd=function(){return"/"};l.chdir=function(e){throw Error("process.chdir is not supported");};l.umask=function(){return 0}},{}],6:[function(l,y,N){!function(m){if("object"==typeof N)y.exports=m();else{try{var v=window}catch(H){v=self}v.SparkMD5=m()}}(function(m){function v(n,h){var g=n[0],e=n[1],k=n[2],d=n[3];e=((e+=((k=((k+=((d=((d+=((g=((g+=(e&k|~e&d)+h[0]-680876936|0)<<7|g>>>25)+e|0)&e|~g&k)+h[1]-389564586|0)<<12|d>>>20)+
g|0)&g|~d&e)+h[2]+606105819|0)<<17|k>>>15)+d|0)&d|~k&g)+h[3]-1044525330|0)<<22|e>>>10)+k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e&k|~e&d)+h[4]-176418897|0)<<7|g>>>25)+e|0)&e|~g&k)+h[5]+1200080426|0)<<12|d>>>20)+g|0)&g|~d&e)+h[6]-1473231341|0)<<17|k>>>15)+d|0)&d|~k&g)+h[7]-45705983|0)<<22|e>>>10)+k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e&k|~e&d)+h[8]+1770035416|0)<<7|g>>>25)+e|0)&e|~g&k)+h[9]-1958414417|0)<<12|d>>>20)+g|0)&g|~d&e)+h[10]-42063|0)<<17|k>>>15)+d|0)&d|~k&g)+h[11]-1990404162|0)<<22|e>>>10)+
k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e&k|~e&d)+h[12]+1804603682|0)<<7|g>>>25)+e|0)&e|~g&k)+h[13]-40341101|0)<<12|d>>>20)+g|0)&g|~d&e)+h[14]-1502002290|0)<<17|k>>>15)+d|0)&d|~k&g)+h[15]+1236535329|0)<<22|e>>>10)+k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e&d|k&~d)+h[1]-165796510|0)<<5|g>>>27)+e|0)&k|e&~k)+h[6]-1069501632|0)<<9|d>>>23)+g|0)&e|g&~e)+h[11]+643717713|0)<<14|k>>>18)+d|0)&g|d&~g)+h[0]-373897302|0)<<20|e>>>12)+k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e&d|k&~d)+h[5]-701558691|0)<<5|g>>>27)+e|
0)&k|e&~k)+h[10]+38016083|0)<<9|d>>>23)+g|0)&e|g&~e)+h[15]-660478335|0)<<14|k>>>18)+d|0)&g|d&~g)+h[4]-405537848|0)<<20|e>>>12)+k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e&d|k&~d)+h[9]+568446438|0)<<5|g>>>27)+e|0)&k|e&~k)+h[14]-1019803690|0)<<9|d>>>23)+g|0)&e|g&~e)+h[3]-187363961|0)<<14|k>>>18)+d|0)&g|d&~g)+h[8]+1163531501|0)<<20|e>>>12)+k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e&d|k&~d)+h[13]-1444681467|0)<<5|g>>>27)+e|0)&k|e&~k)+h[2]-51403784|0)<<9|d>>>23)+g|0)&e|g&~e)+h[7]+1735328473|0)<<14|k>>>18)+
d|0)&g|d&~g)+h[12]-1926607734|0)<<20|e>>>12)+k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e^k^d)+h[5]-378558|0)<<4|g>>>28)+e|0)^e^k)+h[8]-2022574463|0)<<11|d>>>21)+g|0)^g^e)+h[11]+1839030562|0)<<16|k>>>16)+d|0)^d^g)+h[14]-35309556|0)<<23|e>>>9)+k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e^k^d)+h[1]-1530992060|0)<<4|g>>>28)+e|0)^e^k)+h[4]+1272893353|0)<<11|d>>>21)+g|0)^g^e)+h[7]-155497632|0)<<16|k>>>16)+d|0)^d^g)+h[10]-1094730640|0)<<23|e>>>9)+k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e^k^d)+h[13]+681279174|0)<<
4|g>>>28)+e|0)^e^k)+h[0]-358537222|0)<<11|d>>>21)+g|0)^g^e)+h[3]-722521979|0)<<16|k>>>16)+d|0)^d^g)+h[6]+76029189|0)<<23|e>>>9)+k|0;e=((e+=((k=((k+=((d=((d+=((g=((g+=(e^k^d)+h[9]-640364487|0)<<4|g>>>28)+e|0)^e^k)+h[12]-421815835|0)<<11|d>>>21)+g|0)^g^e)+h[15]+530742520|0)<<16|k>>>16)+d|0)^d^g)+h[2]-995338651|0)<<23|e>>>9)+k|0;e=((e+=((d=((d+=(e^((g=((g+=(k^(e|~d))+h[0]-198630844|0)<<6|g>>>26)+e|0)|~k))+h[7]+1126891415|0)<<10|d>>>22)+g|0)^((k=((k+=(g^(d|~e))+h[14]-1416354905|0)<<15|k>>>17)+d|0)|~g))+
h[5]-57434055|0)<<21|e>>>11)+k|0;e=((e+=((d=((d+=(e^((g=((g+=(k^(e|~d))+h[12]+1700485571|0)<<6|g>>>26)+e|0)|~k))+h[3]-1894986606|0)<<10|d>>>22)+g|0)^((k=((k+=(g^(d|~e))+h[10]-1051523|0)<<15|k>>>17)+d|0)|~g))+h[1]-2054922799|0)<<21|e>>>11)+k|0;e=((e+=((d=((d+=(e^((g=((g+=(k^(e|~d))+h[8]+1873313359|0)<<6|g>>>26)+e|0)|~k))+h[15]-30611744|0)<<10|d>>>22)+g|0)^((k=((k+=(g^(d|~e))+h[6]-1560198380|0)<<15|k>>>17)+d|0)|~g))+h[13]+1309151649|0)<<21|e>>>11)+k|0;e=((e+=((d=((d+=(e^((g=((g+=(k^(e|~d))+h[4]-145523070|
0)<<6|g>>>26)+e|0)|~k))+h[11]-1120210379|0)<<10|d>>>22)+g|0)^((k=((k+=(g^(d|~e))+h[2]+718787259|0)<<15|k>>>17)+d|0)|~g))+h[9]-343485551|0)<<21|e>>>11)+k|0;n[0]=g+n[0]|0;n[1]=e+n[1]|0;n[2]=k+n[2]|0;n[3]=d+n[3]|0}function l(d){var h,g=[];for(h=0;64>h;h+=4)g[h>>2]=d.charCodeAt(h)+(d.charCodeAt(h+1)<<8)+(d.charCodeAt(h+2)<<16)+(d.charCodeAt(h+3)<<24);return g}function d(d){var h,g=[];for(h=0;64>h;h+=4)g[h>>2]=d[h]+(d[h+1]<<8)+(d[h+2]<<16)+(d[h+3]<<24);return g}function F(d){var h,g,e,k,n=d.length,m=[1732584193,
-271733879,-1732584194,271733878];for(h=64;h<=n;h+=64)v(m,l(d.substring(h-64,h)));var u=(d=d.substring(h-64)).length;var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;h<u;h+=1)r[h>>2]|=d.charCodeAt(h)<<(h%4<<3);if(r[h>>2]|=128<<(h%4<<3),55<h)for(v(m,r),h=0;16>h;h+=1)r[h]=0;return g=(g=8*n).toString(16).match(/(.*?)(.{0,8})$/),e=parseInt(g[2],16),k=parseInt(g[1],16)||0,r[14]=e,r[15]=k,v(m,r),m}function K(d){var h;for(h=0;h<d.length;h+=1){var g=h,e,k=d[h],n="";for(e=0;4>e;e+=1)n+=C[k>>8*e+4&15]+C[k>>
8*e&15];d[g]=n}return d.join("")}function u(d){return/[\u0080-\uFFFF]/.test(d)&&(d=unescape(encodeURIComponent(d))),d}function x(d){var h,g=[],e=d.length;for(h=0;h<e-1;h+=2)g.push(parseInt(d.substr(h,2),16));return String.fromCharCode.apply(String,g)}function r(){this.reset()}var C="0123456789abcdef".split("");return"5d41402abc4b2a76b9719d911017c592"!==K(F("hello"))&&function(d,h){var g=(65535&d)+(65535&h);return(d>>16)+(h>>16)+(g>>16)<<16|65535&g},"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||
function(){function d(d,g){return 0>(d=0|d||0)?Math.max(d+g,0):Math.min(d,g)}ArrayBuffer.prototype.slice=function(h,g){var e,k,n,v,r=this.byteLength,l=d(h,r),u=r;return g!==m&&(u=d(g,r)),u<l?new ArrayBuffer(0):(e=u-l,k=new ArrayBuffer(e),n=new Uint8Array(k),v=new Uint8Array(this,l,e),n.set(v),k)}}(),r.prototype.append=function(d){return this.appendBinary(u(d)),this},r.prototype.appendBinary=function(d){this._buff+=d;this._length+=d.length;var h=this._buff.length;for(d=64;d<=h;d+=64)v(this._hash,l(this._buff.substring(d-
64,d)));return this._buff=this._buff.substring(d-64),this},r.prototype.end=function(d){var h,g,e=this._buff,k=e.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;h<k;h+=1)n[h>>2]|=e.charCodeAt(h)<<(h%4<<3);return this._finish(n,k),g=K(this._hash),d&&(g=x(g)),this.reset(),g},r.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},r.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},r.prototype.setState=
function(d){return this._buff=d.buff,this._length=d.length,this._hash=d.hash,this},r.prototype.destroy=function(){delete this._hash;delete this._buff;delete this._length},r.prototype._finish=function(d,h){var g=h;if(d[g>>2]|=128<<(g%4<<3),55<g)for(v(this._hash,d),g=0;16>g;g+=1)d[g]=0;var e=(e=8*this._length).toString(16).match(/(.*?)(.{0,8})$/);g=parseInt(e[2],16);e=parseInt(e[1],16)||0;d[14]=g;d[15]=e;v(this._hash,d)},r.hash=function(d,h){return r.hashBinary(u(d),h)},r.hashBinary=function(d,h){var g=
K(F(d));return h?x(g):g},(r.ArrayBuffer=function(){this.reset()}).prototype.append=function(n){var h,g,e=(h=this._buff.buffer,(g=new Uint8Array(h.byteLength+n.byteLength)).set(new Uint8Array(h)),g.set(new Uint8Array(n),h.byteLength),g);h=e.length;this._length+=n.byteLength;for(n=64;n<=h;n+=64)v(this._hash,d(e.subarray(n-64,n)));return this._buff=n-64<h?new Uint8Array(e.buffer.slice(n-64)):new Uint8Array(0),this},r.ArrayBuffer.prototype.end=function(d){var h,g,e=this._buff,k=e.length,n=[0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0];for(h=0;h<k;h+=1)n[h>>2]|=e[h]<<(h%4<<3);return this._finish(n,k),g=K(this._hash),d&&(g=x(g)),this.reset(),g},r.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},r.ArrayBuffer.prototype.getState=function(){var d,h=r.prototype.getState.call(this);return h.buff=(d=h.buff,String.fromCharCode.apply(null,new Uint8Array(d))),h},r.ArrayBuffer.prototype.setState=function(d){var h=
d.buff,g=h.length;var e=new ArrayBuffer(g);var k=new Uint8Array(e);for(e=0;e<g;e+=1)k[e]=h.charCodeAt(e);return d.buff=k,r.prototype.setState.call(this,d)},r.ArrayBuffer.prototype.destroy=r.prototype.destroy,r.ArrayBuffer.prototype._finish=r.prototype._finish,r.ArrayBuffer.hash=function(n,h){var g=new Uint8Array(n);var e,k,m,r,l=g.length,u=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=l;e+=64)v(u,d(g.subarray(e-64,e)));var H=(g=e-64<l?g.subarray(e-64):new Uint8Array(0)).length;var F=[0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<H;e+=1)F[e>>2]|=g[e]<<(e%4<<3);if(F[e>>2]|=128<<(e%4<<3),55<e)for(v(u,F),e=0;16>e;e+=1)F[e]=0;g=(k=(k=8*l).toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(k[2],16),r=parseInt(k[1],16)||0,F[14]=m,F[15]=r,v(u,F),u);k=K(g);return h?x(k):k},r})},{}],7:[function(l,y,N){N=l(10);l=l(11);l.v1=N;l.v4=l;y.exports=l},{10:10,11:11}],8:[function(l,y,N){var m=[];for(l=0;256>l;++l)m[l]=(l+256).toString(16).substr(1);y.exports=function(l,H){var d=H||0;return m[l[d++]]+m[l[d++]]+
m[l[d++]]+m[l[d++]]+"-"+m[l[d++]]+m[l[d++]]+"-"+m[l[d++]]+m[l[d++]]+"-"+m[l[d++]]+m[l[d++]]+"-"+m[l[d++]]+m[l[d++]]+m[l[d++]]+m[l[d++]]+m[l[d++]]+m[l[d++]]}},{}],9:[function(l,y,N){var m="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(m){var v=new Uint8Array(16);y.exports=function(){return m(v),v}}else{var H=Array(16);y.exports=function(){for(var d,l=0;16>l;l++)0==(3&l)&&(d=4294967296*Math.random()),H[l]=d>>>
((3&l)<<3)&255;return H}}},{}],10:[function(l,y,N){var m,v,H=l(9),d=l(8),F=0,K=0;y.exports=function(l,x,r){r=x&&r||0;var u=x||[],n=(l=l||{}).node||m,h=void 0!==l.clockseq?l.clockseq:v;if(null==n||null==h){var g=H();null==n&&(n=m=[1|g[0],g[1],g[2],g[3],g[4],g[5]]);null==h&&(h=v=16383&(g[6]<<8|g[7]))}g=void 0!==l.msecs?l.msecs:(new Date).getTime();var e=void 0!==l.nsecs?l.nsecs:K+1,k=g-F+(e-K)/1E4;if(0>k&&void 0===l.clockseq&&(h=h+1&16383),(0>k||F<g)&&void 0===l.nsecs&&(e=0),1E4<=e)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");
F=g;v=h;l=(1E4*(268435455&(g+=122192928E5))+(K=e))%4294967296;u[r++]=l>>>24&255;u[r++]=l>>>16&255;u[r++]=l>>>8&255;u[r++]=255&l;l=g/4294967296*1E4&268435455;u[r++]=l>>>8&255;u[r++]=255&l;u[r++]=l>>>24&15|16;u[r++]=l>>>16&255;u[r++]=h>>>8|128;u[r++]=255&h;for(h=0;6>h;++h)u[r+h]=n[h];return x||d(u)}},{8:8,9:9}],11:[function(l,y,N){var m=l(9),v=l(8);y.exports=function(l,d,F){F=d&&F||0;"string"==typeof l&&(d="binary"===l?Array(16):null,l=null);var H=(l=l||{}).random||(l.rng||m)();if(H[6]=15&H[6]|64,H[8]=
63&H[8]|128,d)for(l=0;16>l;++l)d[F+l]=H[l];return d||v(H)}},{8:8,9:9}],12:[function(l,y,N){function m(l,m,d){var v=d[d.length-1];l===v.element&&(d.pop(),v=d[d.length-1]);d=v.element;v=v.index;Array.isArray(d)?d.push(l):v===m.length-2?d[m.pop()]=l:m.push(l)}N.stringify=function(l){var m=[];m.push({obj:l});for(var d,v,y,u,x,r,C="";d=m.pop();)if(l=d.obj,C+=d.prefix||"",d=d.val||"")C+=d;else if("object"!=typeof l)C+=void 0===l?null:JSON.stringify(l);else if(null===l)C+="null";else if(Array.isArray(l)){m.push({val:"]"});
for(d=l.length-1;0<=d;d--)v=0===d?"":",",m.push({obj:l[d],prefix:v});m.push({val:"["})}else{for(y in v=[],l)l.hasOwnProperty(y)&&v.push(y);m.push({val:"}"});for(d=v.length-1;0<=d;d--)x=l[u=v[d]],r=0<d?",":"",r+=JSON.stringify(u)+":",m.push({obj:x,prefix:r});m.push({val:"{"})}return C};N.parse=function(l){for(var v,d,y,K,u,x,r=[],C=[],n=0;;)if("}"!==(v=l[n++])&&"]"!==v&&void 0!==v)switch(v){case " ":case "\t":case "\n":case ":":case ",":break;case "n":n+=3;m(null,r,C);break;case "t":n+=3;m(!0,r,C);
break;case "f":n+=4;m(!1,r,C);break;case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":case "-":d="";for(n--;;){if(y=l[n++],!/[\d\.\-e\+]/.test(y)){n--;break}d+=y}m(parseFloat(d),r,C);break;case '"':d="";K=void 0;for(u=0;'"'!==(x=l[n++])||"\\"===K&&1==u%2;)d+=x,"\\"===(K=x)?u++:u=0;m(JSON.parse('"'+d+'"'),r,C);break;case "[":d={element:[],index:r.length};r.push(d.element);C.push(d);break;case "{":d={element:{},index:r.length};r.push(d.element);C.push(d);break;
default:throw Error("unexpectedly reached end of input: "+v);}else{if(1===r.length)return r.pop();m(r.pop(),r,C)}}},{}],13:[function(l,y,N){(function(m,v){function H(a){return a&&"object"==typeof a&&"default"in a?a["default"]:a}function d(a){var b;if(!a||"object"!=typeof a)return a;if(Array.isArray(a)){var c=[];var f=0;for(b=a.length;f<b;f++)c[f]=d(a[f]);return c}if(a instanceof Date)return a.toISOString();if("undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer||"undefined"!=typeof Blob&&a instanceof
Blob)return a instanceof ArrayBuffer?"function"==typeof a.slice?a=a.slice(0):(f=new ArrayBuffer(a.byteLength),c=new Uint8Array(f),a=new Uint8Array(a),a=(c.set(a),f)):(f=a.size,c=a.type,a="function"==typeof a.slice?a.slice(0,f,c):a.webkitSlice(0,f,c)),a;c=Object.getPrototypeOf(a);null===c?c=!0:(c=c.constructor,c="function"==typeof c&&c instanceof c&&Hb.call(c)==Fc);if(!c)return a;for(f in c={},a)Object.prototype.hasOwnProperty.call(a,f)&&(b=d(a[f]),void 0!==b&&(c[f]=b));return c}function F(a){var b=
!1;return va(function(c){if(b)throw Error("once called more than once");b=!0;a.apply(this,c)})}function K(a){return va(function(b){b=d(b);var c=this,f="function"==typeof b[b.length-1]&&b.pop(),t=new Promise(function(f,t){var d;try{var e=F(function(a,b){a?t(a):f(b)});b.push(e);(d=a.apply(c,b))&&"function"==typeof d.then&&f(d)}catch(J){t(J)}});return f&&t.then(function(a){f(null,a)},f),t})}function u(a,b){return K(va(function(c){if(this._closed)return Promise.reject(Error("database is closed"));if(this._destroyed)return Promise.reject(Error("database is destroyed"));
var f=this;return function(a,b,c){if(a.constructor.listeners("debug").length){for(var f=["api",a.name,b],t=0;t<c.length-1;t++)f.push(c[t]);a.constructor.emit("debug",f);var d=c[c.length-1];c[c.length-1]=function(c,f){var t=["api",a.name,b];t=t.concat(c?["error",c]:["success",f]);a.constructor.emit("debug",t);d(c,f)}}}(f,a,c),this.taskqueue.isReady?b.apply(this,c):new Promise(function(b,d){f.taskqueue.addTask(function(t){t?d(t):b(f[a].apply(f,c))})})}))}function x(){this._store={}}function r(a){if(this._store=
new x,a&&Array.isArray(a))for(var b=0,c=a.length;b<c;b++)this.add(a[b])}function C(a,b){for(var c={},f=0,t=b.length;f<t;f++){var d=b[f];d in a&&(c[d]=a[d])}return c}function n(a){return a}function h(a){return[{ok:a}]}function g(a,b,c){function f(){var a;++k===g&&(a=[],J.forEach(function(b){b.docs.forEach(function(c){a.push({id:b.id,docs:[c]})})}),c(null,{results:a}))}function t(){if(!(p>=R.length)){var c=R.slice(p,Math.min(p+6,R.length));var d=p;c.forEach(function(c,p){var g=d+p,Ca=e.get(c),D=C(Ca[0],
["atts_since","attachments"]);D.open_revs=Ca.map(function(a){return a.rev});D.open_revs=D.open_revs.filter(n);var w=n;0===D.open_revs.length&&(delete D.open_revs,w=h);["revs","attachments","binary","ajax","latest"].forEach(function(a){a in b&&(D[a]=b[a])});a.get(c,D,function(a,b){var d=a?[{error:a}]:w(b);J[g]={id:c,docs:d};f();t()})});p+=c.length}}var d=b.docs,e=new V;d.forEach(function(a){e.has(a.id)?e.get(a.id).push(a):e.set(a.id,[a])});var g=e.size,k=0,J=Array(g),R=[];e.forEach(function(a,b){R.push(b)});
var p=0;t()}function e(){W.EventEmitter.call(this);this._listeners={};var a=this;Da&&addEventListener("storage",function(b){a.emit(b.key)})}function k(a){if("undefined"!=typeof console&&"function"==typeof console[a]){var b=Array.prototype.slice.call(arguments,1);console[a].apply(console,b)}}function N(a){var b,c,f=0;return a||(f=2E3),b=a,c=f,b=parseInt(b,10)||0,(c=parseInt(c,10))!=c||c<=b?c=(b||1)<<1:c+=1,6E5<c&&(b=3E5,c=6E5),~~((c-b)*Math.random()+b)}function Ka(a,b){k("info","The above "+a+" is totally normal. "+
b)}function I(a,b,c){Error.call(this,c);this.status=a;this.name=b;this.message=c;this.error=!0}function B(a,b){function c(b){for(var c in a)"function"!=typeof a[c]&&(this[c]=a[c]);void 0!==b&&(this.reason=b)}return c.prototype=I.prototype,new c(b)}function ua(a){if("object"!=typeof a){var b=a;(a=Ib).data=b}return"error"in a&&"conflict"===a.error&&(a.name="conflict",a.status=409),"name"in a||(a.name=a.error||"unknown"),"status"in a||(a.status=500),"message"in a||(a.message=a.message||a.reason),a}function Ya(a){var b=
{},c=a.filter&&"function"==typeof a.filter;return b.query=a.query_params,function(f){f.doc||(f.doc={});var t;if(t=c)try{t=!(0,a.filter)(f.doc,b)}catch(D){t=B(Ma,"Filter function threw: "+D.toString())}if("object"==typeof t)return t;if(t)return!1;if(a.include_docs){if(!a.attachments)for(var d in f.doc._attachments)f.doc._attachments.hasOwnProperty(d)&&(f.doc._attachments[d].stub=!0)}else delete f.doc;return!0}}function La(a){for(var b=[],c=0,f=a.length;c<f;c++)b=b.concat(a[c]);return b}function Gb(a){var b;
if(a?"string"!=typeof a?b=B(Jb):/^_/.test(a)&&!/^_(design|local)/.test(a)&&(b=B(Hc)):b=B(Ic),b)throw b;}function ea(a){return"boolean"==typeof a._remote?a._remote:"function"==typeof a.type&&(k("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===a.type())}function Za(a){if(!a)return null;var b=a.split("/");return 2===b.length?b:1===b.length?[a,a]:null}function Kb(a){return(a=Za(a))?a.join("/"):null}function Lb(a){a=Jc.exec(a);for(var b={},c=14;c--;){var f=
Mb[c],t=a[c]||"",d=-1!==["user","password"].indexOf(f);b[f]=d?decodeURIComponent(t):t}return b.queryKey={},b[Mb[12]].replace(Kc,function(a,c,f){c&&(b.queryKey[c]=f)}),b}function $a(a,b){var c=[],f=[],t;for(t in b)b.hasOwnProperty(t)&&(c.push(t),f.push(b[t]));return c.push(a),Function.apply(null,c).apply(null,f)}function Na(a,b,c){return new Promise(function(f,t){a.get(b,function(d,e){if(d){if(404!==d.status)return t(d);e={}}var g=e._rev,D=c(e);if(!D)return f({updated:!1,rev:g});D._id=b;D._rev=g;f(a.put(D).then(function(a){return{updated:!0,
rev:a.rev}},function(b){if(409!==b.status)throw b;return Na(a,D._id,c)}))})})}function ab(a,b){a=a||[];b=b||{};try{return new Blob(a,b)}catch(t){if("TypeError"!==t.name)throw t;for(var c=new ("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),f=0;f<a.length;f+=1)c.append(a[f]);return c.getBlob(b.type)}}function bb(a,b){for(var c=a.length,f=new ArrayBuffer(c),t=new Uint8Array(f),d=0;d<c;d++)t[d]=
a.charCodeAt(d);return ab([f],{type:b})}function cb(a,b){return bb(atob(a),b)}function Nb(a,b){var c=new FileReader,f="function"==typeof c.readAsBinaryString;c.onloadend=function(a){var c=a.target.result||"";if(f)return b(c);a="";c=new Uint8Array(c);for(var t=c.byteLength,d=0;d<t;d++)a+=String.fromCharCode(c[d]);b(a)};f?c.readAsBinaryString(a):c.readAsArrayBuffer(a)}function Ob(a,b){Nb(a,function(a){b(a)})}function db(a,b){Ob(a,function(a){b(btoa(a))})}function Lc(a,b,c,f,t){var d;(0<c||f<b.size)&&
(b=(d=b).webkitSlice?d.webkitSlice(c,f):d.slice(c,f));var e=function(b){a.append(b);t()};(c=new FileReader).onloadend=function(a){a=a.target.result||new ArrayBuffer(0);e(a)};c.readAsArrayBuffer(b)}function Mc(a,b,c,f,d){(0<c||f<b.length)&&(b=b.substring(c,f));a.appendBinary(b);d()}function eb(a,b){function c(){Nc(d)}function f(){var a=R.end(!0);a=btoa(a);b(a);R.destroy()}function d(){var b=J*k;p(R,a,b,b+k,++J<h?c:f)}var e="string"==typeof a,g=e?a.length:a.size,k=Math.min(32768,g),h=Math.ceil(g/k),
J=0,R=e?new Oa:new Oa.ArrayBuffer,p=e?Mc:Lc;d()}function Pb(a,b){var c=d(a);return b?(delete c._rev_tree,Oa.hash(JSON.stringify(c))):Qb.v4().replace(/-/g,"").toLowerCase()}function na(a){var b,c,f,d;for(a=a.rev_tree.slice();d=a.pop();){var e=d.ids,g=e[2];d=d.pos;if(g.length){e=0;for(var k=g.length;e<k;e++)a.push({pos:d+1,ids:g[e]})}else g=!!e[1].deleted,e=e[0],b&&!(f!==g?f:c!==d?c<d:b<e)||(b=e,c=d,f=g)}return c+"-"+b}function oa(a,b){for(var c,f=a.slice();c=f.pop();){var d=c.pos,e=c.ids,g=e[2];c=
b(0===g.length,d,e[0],c.ctx,e[1]);e=0;for(var k=g.length;e<k;e++)f.push({pos:d+1,ids:g[e],ctx:c})}}function Oc(a,b){return a.pos-b.pos}function fb(a){var b=[];oa(a,function(a,c,d,e,g){a&&b.push({rev:c+"-"+d,pos:c,opts:g})});b.sort(Oc).reverse();a=0;for(var c=b.length;a<c;a++)delete b[a].pos;return b}function gb(a){var b=na(a);a=fb(a.rev_tree);for(var c=[],f=0,d=a.length;f<d;f++){var e=a[f];e.rev===b||e.opts.deleted||c.push(e.rev)}return c}function Rb(a){var b,c=[];for(a=a.slice();b=a.pop();){var f=
b.pos,d=b.ids,e=d[0],g=d[1];d=d[2];var k=0===d.length;b=b.history?b.history.slice():[];b.push({id:e,opts:g});k&&c.push({pos:f+1-b.length,ids:b});e=0;for(g=d.length;e<g;e++)a.push({pos:f+1,ids:d[e],history:b})}return c.reverse()}function Pc(a,b){return a.pos-b.pos}function Sb(a,b){for(var c,f,d=b,e=a.length;d<e;d++){var g=a[d];g=[g.id,g.opts,[]];f?(f[2].push(g),f=g):c=f=g}return c}function Qc(a,b){return a[0]<b[0]?-1:1}function Tb(a,b){for(var c,f,d,e=[{tree1:a,tree2:b}],g=!1;0<e.length;){var k=e.pop(),
h=k.tree1;k=k.tree2;(h[1].status||k[1].status)&&(h[1].status="available"===h[1].status||"available"===k[1].status?"available":"missing");for(var J=0;J<k[2].length;J++)if(h[2][0]){c=!1;for(f=0;f<h[2].length;f++)h[2][f][0]===k[2][J][0]&&(e.push({tree1:h[2][f],tree2:k[2][J]}),c=!0);if(!c){g="new_branch";c=h[2];f=k[2][J];void 0;d=void 0;for(var R=c,p=f,A=Qc,l=0,q=R.length;l<q;)0>A(R[d=l+q>>>1],p)?l=d+1:q=d;d=l;c.splice(d,0,f)}}else g="new_leaf",h[2][0]=k[2][J]}return{conflicts:g,tree:a}}function Ub(a,
b,c){var f=[],d=!1,e=!1;if(!a.length)return{tree:[b],conflicts:"new_leaf"};for(var g=0,k=a.length;g<k;g++){var h=a[g];if(h.pos===b.pos&&h.ids[0]===b.ids[0]){var J=Tb(h.ids,b.ids);f.push({pos:h.pos,ids:J.tree});d=d||J.conflicts;e=!0}else if(!0!==c){var R=h.pos<b.pos?h:b,p=h.pos<b.pos?b:h,A=[],l=[];for(l.push({ids:R.ids,diff:p.pos-R.pos,parent:null,parentIdx:null});0<l.length;){var q=l.pop();if(0!==q.diff)for(var m=q.ids[2],G=0,ka=m.length;G<ka;G++)l.push({ids:m[G],diff:q.diff-1,parent:q.ids,parentIdx:G});
else q.ids[0]===p.ids[0]&&A.push(q)}(A=A[0])?(J=Tb(A.ids,p.ids),A.parent[2][A.parentIdx]=J.tree,f.push({pos:R.pos,ids:R.ids}),d=d||J.conflicts,e=!0):f.push(h)}else f.push(h)}return e||f.push(b),f.sort(Pc),{tree:f,conflicts:d||"internal_node"}}function Vb(a,b,c){a=Ub(a,b);c=function(a,b){for(var c,f,d=Rb(a),e=0,g=d.length;e<g;e++){var t=d[e],p=t.ids;if(p.length>b){c||(c={});var k=p.length-b;var h={pos:t.pos+k,ids:Sb(p,k)};for(var q=0;q<k;q++)c[t.pos+q+"-"+p[q].id]=!0}else h={pos:t.pos,ids:Sb(p,0)};
f=f?Ub(f,h,!0).tree:[h]}return c&&oa(f,function(a,b,f){delete c[b+"-"+f]}),{tree:f,revs:c?Object.keys(c):[]}}(a.tree,c);return{tree:c.tree,stemmedRevs:c.revs,conflicts:a.conflicts}}function Rc(a){return a.ids}function la(a,b){b||(b=na(a));for(var c,f=b.substring(b.indexOf("-")+1),d=a.rev_tree.map(Rc);c=d.pop();){if(c[0]===f)return!!c[1].deleted;d=d.concat(c[2])}}function pa(a){return/^_local/.test(a)}function Ea(a,b,c){function f(){e.cancel()}W.EventEmitter.call(this);var e=this;this.db=a;var g=(b=
b?d(b):{}).complete=F(function(b,c){var d;b?0<("listenerCount"in(d=e)?d.listenerCount("error"):W.EventEmitter.listenerCount(d,"error"))&&e.emit("error",b):e.emit("complete",c);e.removeAllListeners();a.removeListener("destroyed",f)});c&&(e.on("complete",function(a){c(null,a)}),e.on("error",c));a.once("destroyed",f);b.onChange=function(a,b,c){if(!e.isCancelled)try{e.emit("change",a,b,c)}catch(R){k("error",'Error in .on("change", function):',R)}};var h=new Promise(function(a,c){b.complete=function(b,
f){b?c(b):a(f)}});e.once("cancel",function(){a.removeListener("destroyed",f);b.complete(null,{status:"cancelled"})});this.then=h.then.bind(h);this["catch"]=h["catch"].bind(h);this.then(function(a){g(null,a)},g);a.taskqueue.isReady?e.validateChanges(b):a.taskqueue.addTask(function(a){a?b.complete(a):e.isCancelled?e.emit("cancel"):e.validateChanges(b)})}function Sc(a,b,c){var f=[{rev:a._rev}];"all_docs"===c.style&&(f=fb(b.rev_tree).map(function(a){return{rev:a.rev}}));f={id:b.id,changes:f,doc:a};return la(b,
a._rev)&&(f.deleted=!0),c.conflicts&&(f.doc._conflicts=gb(b),f.doc._conflicts.length||delete f.doc._conflicts),f}function hb(a,b){return function(c,f){c||f[0]&&f[0].error?((c=c||f[0]).docId=b,a(c)):a(null,f.length?f[0]:f)}}function Tc(a,b){var c=a._id;var f=b._id;c=c<f?-1:f<c?1:0;0===c&&(c=a._revisions?a._revisions.start:0,f=b._revisions?b._revisions.start:0,c=c<f?-1:f<c?1:0);return c}function M(){for(var a in W.EventEmitter.call(this),M.prototype)"function"==typeof this[a]&&(this[a]=this[a].bind(this))}
function Fa(){this.failed=this.isReady=!1;this.queue=[]}function z(a,b){if(!(this instanceof z))return new z(a,b);var c=this;if(b=b||{},a&&"object"==typeof a&&(a=(b=a).name,delete b.name),void 0===b.deterministic_revs&&(b.deterministic_revs=!0),this.__opts=b=d(b),c.auto_compaction=b.auto_compaction,c.prefix=z.prefix,"string"!=typeof a)throw Error("Missing/invalid DB name");var f=function(a,b){var c=a.match(/([a-z-]*):\/\/(.*)/);if(c)return{name:/https?/.test(c[1])?c[1]+"://"+c[2]:c[2],adapter:c[1]};
var f=z.adapters,d=z.preferredAdapters;c=z.prefix;var e=b.adapter;if(!e)for(var g=0;g<d.length&&"idb"===(e=d[g])&&"websql"in f&&Da&&localStorage["_pouch__websqldb_"+c+a];++g)k("log",'PouchDB is downgrading "'+a+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');f=f[e];return{name:f&&"use_prefix"in f&&!f.use_prefix?a:c+a,adapter:e}}((b.prefix||"")+a,b);if(b.name=f.name,b.adapter=b.adapter||f.adapter,c.name=a,c._adapter=b.adapter,z.emit("debug",["adapter","Picked adapter: ",
b.adapter]),!z.adapters[b.adapter]||!z.adapters[b.adapter].valid())throw Error("Invalid Adapter: "+b.adapter);M.call(c);c.taskqueue=new Fa;c.adapter=b.adapter;z.adapters[b.adapter].call(c,b,function(a){if(a)return c.taskqueue.fail(a);!function(a){function b(b){a.removeListener("closed",c);b||a.constructor.emit("destroyed",a.name)}function c(){a.removeListener("destroyed",b);a.constructor.emit("unref",a)}a.once("destroyed",b);a.once("closed",c);a.constructor.emit("ref",a)}(c);c.emit("created",c);z.emit("created",
c.name);c.taskqueue.ready(c)})}function Wb(a,b){for(var c=a,f=0,d=b.length;f<d&&(c=c[b[f]]);f++);return c}function Xb(a){for(var b=[],c="",f=0,d=a.length;f<d;f++){var e=a[f];"."===e?0<f&&"\\"===a[f-1]?c=c.substring(0,c.length-1)+".":(b.push(c),c=""):c+=e}return b.push(c),b}function Pa(a){var b={};return a.forEach(function(a){Object.keys(a).forEach(function(c){var f=a[c];if("object"!=typeof f&&(f={$eq:f}),-1<Yb.indexOf(c))f instanceof Array?b[c]=f.map(function(a){return Pa([a])}):b[c]=Pa([f]);else{var d=
b[c]=b[c]||{};Object.keys(f).forEach(function(a){var b=f[a];return"$gt"===a||"$gte"===a?function(a,b,c){void 0===c.$eq&&(void 0!==c.$gte?"$gte"===a?b>c.$gte&&(c.$gte=b):b>=c.$gte&&(delete c.$gte,c.$gt=b):void 0!==c.$gt?"$gte"===a?b>c.$gt&&(delete c.$gt,c.$gte=b):b>c.$gt&&(c.$gt=b):c[a]=b)}(a,b,d):"$lt"===a||"$lte"===a?function(a,b,c){void 0===c.$eq&&(void 0!==c.$lte?"$lte"===a?b<c.$lte&&(c.$lte=b):b<=c.$lte&&(delete c.$lte,c.$lt=b):void 0!==c.$lt?"$lte"===a?b<c.$lt&&(delete c.$lt,c.$lte=b):b<c.$lt&&
(c.$lt=b):c[a]=b)}(a,b,d):"$ne"===a?void("$ne"in d?d.$ne.push(b):d.$ne=[b]):"$eq"===a?(delete d.$gt,delete d.$gte,delete d.$lt,delete d.$lte,delete d.$ne,void(d.$eq=b)):void(d[a]=b)})}})}),b}function S(a,b){if(a===b)return 0;a=qa(a);b=qa(b);var c,f,d=ib(a),e=ib(b);if(0!=d-e)return d-e;switch(typeof a){case "number":return a-b;case "boolean":return a<b?-1:1;case "string":return(c=a)===(f=b)?0:f<c?1:-1}return Array.isArray(a)?function(a,b){for(var c=Math.min(a.length,b.length),f=0;f<c;f++){var d=S(a[f],
b[f]);if(0!==d)return d}return a.length===b.length?0:a.length>b.length?1:-1}(a,b):function(a,b){for(var c=Object.keys(a),f=Object.keys(b),d=Math.min(c.length,f.length),e=0;e<d;e++){var g=S(c[e],f[e]);if(0!==g||0!==(g=S(a[c[e]],b[f[e]])))return g}return c.length===f.length?0:c.length>f.length?1:-1}(a,b)}function qa(a){switch(typeof a){case "undefined":return null;case "number":return a===1/0||a===-1/0||isNaN(a)?null:a;case "object":var b=a;if(Array.isArray(a)){var c=a.length;a=Array(c);for(var f=0;f<
c;f++)a[f]=qa(b[f])}else{if(a instanceof Date)return a.toJSON();if(null!==a)for(c in a={},b)b.hasOwnProperty(c)&&(f=b[c],void 0!==f&&(a[c]=qa(f)))}}return a}function Uc(a){if(null!==a)switch(typeof a){case "boolean":return a?1:0;case "number":if(0===a)var b="1";else{b=a.toExponential().split(/e\+?/);var c=parseInt(b[1],10);a=0>a;var f=((a?-c:c)- -324).toString();var d="0";c="";for(var e=3-f.length;c.length<e;)c+=d;c=(a?"0":"2")+(""+(c+f));b=Math.abs(parseFloat(b[0]));a&&(b=10-b);a=b.toFixed(20);b=
(a=a.replace(/\.?0+$/,""),c+(""+a))}return b;case "string":return a.replace(/\u0002/g,"\u0002\u0002").replace(/\u0001/g,"\u0001\u0002").replace(/\u0000/g,"\u0001\u0001");case "object":b=(d=Array.isArray(a))?a:Object.keys(a);c=-1;e=b.length;f="";if(d)for(;++c<e;)f+=aa(b[c]);else for(;++c<e;)d=b[c],f+=aa(d)+aa(a[d]);return f}return""}function aa(a){return ib(a=qa(a))+""+Uc(a)+"\x00"}function ib(a){var b=["boolean","number","string","object"].indexOf(typeof a);return~b?null===a?1:Array.isArray(a)?5:
3>b?b+2:b+3:Array.isArray(a)?5:void 0}function Vc(a,b,c){if(a=a.filter(function(a){return wa(a.doc,b.selector,c)}),b.sort){var f=function(a){function b(b){return a.map(function(a){a=Xb(Object.keys(a)[0]);return Wb(b,a)})}return function(a,c){var f,d,e=S(b(a.doc),b(c.doc));return 0!==e?e:(f=a.doc._id,d=c.doc._id,f<d?-1:d<f?1:0)}}(b.sort);a=a.sort(f);"string"!=typeof b.sort[0]&&"desc"===(d=b.sort[0])[Object.keys(d)[0]]&&(a=a.reverse())}var d;if("limit"in b||"skip"in b)f=b.skip||0,a=a.slice(f,("limit"in
b?b.limit:a.length)+f);return a}function wa(a,b,c){return c.every(function(c){var f=b[c],d=Xb(c),e=Wb(a,d);return-1<Yb.indexOf(c)?function(a,b,c){return"$or"===a?b.some(function(a){return wa(c,a,Object.keys(a))}):"$not"===a?!wa(c,b,Object.keys(b)):!b.find(function(a){return wa(c,a,Object.keys(a))})}(c,f,a):jb(f,a,d,e)})}function jb(a,b,c,f){return!a||Object.keys(a).every(function(d){var e=a[d];if(!Zb[d])throw Error('unknown operator "'+d+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');
return Zb[d](b,e,c,f)})}function $b(a,b){return b.some(function(b){return a instanceof Array?-1<a.indexOf(b):a===b})}function Wc(a,b){if("object"!=typeof b)throw Error("Selector error: expected a JSON object");var c=Vc([{doc:a}],{selector:b=function(a){var b=d(a);a=!1;"$and"in b&&(b=Pa(b.$and),a=!0);["$or","$nor"].forEach(function(a){a in b&&b[a].forEach(function(a){for(var b=Object.keys(a),c=0;c<b.length;c++){var f=b[c],d=a[f];"object"==typeof d&&null!==d||(a[f]={$eq:d})}})});"$not"in b&&(b.$not=
Pa([b.$not]));for(var c=Object.keys(b),f=0;f<c.length;f++){var e=c[f],g=b[e];"object"!=typeof g||null===g?g={$eq:g}:"$ne"in g&&!a&&(g.$ne=[g.$ne]);b[e]=g}return b}(b)},Object.keys(b));return c&&1===c.length}function Xc(a,b){if(a.selector&&a.filter&&"_selector"!==a.filter)return b(Error('selector invalid for filter "'+("string"==typeof a.filter?a.filter:"function")+'"'));b()}function Yc(a){a.view&&!a.filter&&(a.filter="_view");a.selector&&!a.filter&&(a.filter="_selector");a.filter&&"string"==typeof a.filter&&
("_view"===a.filter?a.view=Kb(a.view):a.filter=Kb(a.filter))}function Zc(a,b){return b.filter&&"string"==typeof b.filter&&!b.doc_ids&&!ea(a.db)}function $c(a,b){var c=b.complete;if("_view"===b.filter){if(!b.view||"string"!=typeof b.view){var f=B(Ma,"`view` filter parameter not found or invalid.");return c(f)}var d=Za(b.view);a.db.get("_design/"+d[0],function(f,e){if(a.isCancelled)return c(null,{status:"cancelled"});if(f)return c(ua(f));var g=e&&e.views&&e.views[d[1]]&&e.views[d[1]].map;if(!g)return c(B(ba,
e.views?"missing json key: "+d[1]:"missing json key: views"));b.filter=$a(['return function(doc) {\n  "use strict";\n  var emitted = false;\n  var emit = function (a, b) {\n    emitted = true;\n  };',"  var view = "+g+";","  view(doc);\n  if (emitted) {\n    return true;\n  }\n};"].join("\n"),{});a.doChanges(b)})}else if(b.selector)b.filter=function(a){return Wc(a,b.selector)},a.doChanges(b);else{var e=Za(b.filter);a.db.get("_design/"+e[0],function(f,d){if(a.isCancelled)return c(null,{status:"cancelled"});
if(f)return c(ua(f));var g=d&&d.filters&&d.filters[e[1]];if(!g)return c(B(ba,d&&d.filters?"missing json key: "+e[1]:"missing json key: filters"));b.filter=$a('"use strict";\nreturn '+g+";",{});a.doChanges(b)})}}function ac(a){return a.reduce(function(a,c){return a[c]=!0,a},{})}function bc(a){if(!/^\d+-./.test(a))return B(cc);var b=a.indexOf("-"),c=a.substring(0,b);a=a.substring(b+1);return{prefix:parseInt(c,10),id:a}}function dc(a,b,c){var f;c||(c={deterministic_revs:!0});var d={status:"available"};
if(a._deleted&&(d.deleted=!0),b)if(a._id||(a._id=Qa()),f=Pb(a,c.deterministic_revs),a._rev){if((b=bc(a._rev)).error)return b;a._rev_tree=[{pos:b.prefix,ids:[b.id,{status:"missing"},[[f,d,[]]]]}];var e=b.prefix+1}else a._rev_tree=[{pos:1,ids:[f,d,[]]}],e=1;else{if(a._revisions){f=a._revisions;e=f.start-f.ids.length+1;f=f.ids;b=[f[0],d,[]];c=1;for(var g=f.length;c<g;c++)b=[f[c],{status:"missing"},[b]];a._rev_tree=[{pos:e,ids:b}];e=a._revisions.start;f=a._revisions.ids[0]}if(!a._rev_tree){if((b=bc(a._rev)).error)return b;
e=b.prefix;f=b.id;a._rev_tree=[{pos:e,ids:[f,d,[]]}]}}Gb(a._id);a._rev=e+"-"+f;d={metadata:{},data:{}};for(var k in a)if(Object.prototype.hasOwnProperty.call(a,k)){if((e="_"===k[0])&&!ad[k])throw a=B(ec,k),a.message=ec.message+": "+k,a;e&&!bd[k]?d.metadata[k.slice(1)]=a[k]:d.data[k]=a[k]}return d}function cd(a,b,c){try{var f=atob(a.data)}catch(t){f={error:B(fc,"Attachment is not a valid base64 string")}}if(f.error)return c(f.error);a.length=f.length;a.data="blob"===b?bb(f,a.content_type):"base64"===
b?btoa(f):f;eb(f,function(b){a.digest="md5-"+b;c()})}function dd(a,b,c){if(a.stub)return c();"string"==typeof a.data?cd(a,b,c):eb(a.data,function(f){a.digest="md5-"+f;a.length=a.data.size||a.data.length||0;"binary"===b?Ob(a.data,function(b){a.data=b;c()}):"base64"===b?db(a.data,function(b){a.data=b;c()}):c()})}function ed(a,b,c,f,d,e,g,k,h){a=a||1E3;var t=k.new_edits,l=new V,p=0,D=b.length;b.forEach(function(a,b){if(a._id&&pa(a._id))c[a._deleted?"_removeLocal":"_putLocal"](a,{ctx:d},function(a,c){e[b]=
a||c;++p===D&&h&&h()});else{var f=a.metadata.id;l.has(f)?(D--,l.get(f).push([a,b])):l.set(f,[[a,b]])}});l.forEach(function(b,c){function d(){++l<b.length?q():++p===D&&h&&h()}function q(){var p=b[l],w=p[0];p=p[1];if(f.has(c)){var h=a,q=f.get(c);b:{var D=w.metadata.rev;var A=q.rev_tree.slice();var G=D.split("-");D=parseInt(G[0],10);for(var ja=G[1];G=A.pop();){if(G.pos===D&&G.ids[0]===ja){A=!0;break b}for(var Ga=G.ids[2],ma=0,Gc=Ga.length;ma<Gc;ma++)A.push({pos:G.pos+1,ids:Ga[ma]})}A=!1}A&&!t?(e[p]=
w,d()):(G=q.winningRev||na(q),A="deleted"in q?q.deleted:la(q,G),D="deleted"in w.metadata?w.metadata.deleted:la(w.metadata),ja=/^1-/.test(w.metadata.rev),A&&!D&&t&&ja&&(ja=w.data,ja._rev=G,ja._id=w.metadata.id,w=dc(ja,t)),G=Vb(q.rev_tree,w.metadata.rev_tree[0],h),t&&(A&&D&&"new_leaf"!==G.conflicts||!A&&"new_leaf"!==G.conflicts||A&&!D&&"new_branch"===G.conflicts)?(w=B(xa),e[p]=w,d()):(h=w.metadata.rev,w.metadata.rev_tree=G.tree,w.stemmedRevs=G.stemmedRevs||[],q.rev_map&&(w.metadata.rev_map=q.rev_map),
q=na(w.metadata),D=la(w.metadata,q),A=A===D?0:A<D?-1:1,g(w,q,D,h===q?D:la(w.metadata,h),!0,A,p,d)))}else q=Vb([],w.metadata.rev_tree[0],a),w.metadata.rev_tree=q.tree,w.stemmedRevs=q.stemmedRevs||[],q=na(w.metadata),h=la(w.metadata,q),"was_delete"in k&&h?(e[p]=B(ba,"deleted"),d()):t&&"missing"===w.metadata.rev_tree[0].ids[1].status?(w=B(xa),e[p]=w,d()):g(w,q,h,h,!1,h?0:1,p,d)}var l=0;q()})}function ha(a){return function(b){var c="unknown_error";b.target&&b.target.error&&(c=b.target.error.name||b.target.error.message);
a(B(kb,c,b.type))}}function lb(a,b,c){try{var f=JSON.stringify(a)}catch(t){f=hc.stringify(a)}return{data:f,winningRev:b,deletedOrLocal:c?"1":"0",seq:a.seq,id:a.id}}function ra(a){if(!a)return null;var b=a.data;try{var c=JSON.parse(b)}catch(f){c=hc.parse(b)}return c.winningRev=a.winningRev,c.deleted="1"===a.deletedOrLocal,c.seq=a.seq,c}function Ra(a){if(!a)return a;var b=a._doc_id_rev.lastIndexOf(":");return a._id=a._doc_id_rev.substring(0,b-1),a._rev=a._doc_id_rev.substring(b+1),delete a._doc_id_rev,
a}function ic(a,b,c,f){c?f(a?"string"!=typeof a?a:cb(a,b):ab([""],{type:b})):a?"string"!=typeof a?Nb(a,function(a){f(btoa(a))}):f(a):f("")}function jc(a,b,c,f){var d=Object.keys(a._attachments||{});if(!d.length)return f&&f();var e=0;d.forEach(function(g){if(b.attachments&&b.include_docs){var k=a._attachments[g];g=k.digest;c.objectStore("attach-store").get(g).onsuccess=function(a){k.body=a.target.result.body;++e===d.length&&f&&f()}}else a._attachments[g].stub=!0,++e===d.length&&f&&f()})}function mb(a,
b){return Promise.all(a.map(function(a){if(a.doc&&a.doc._attachments){var c=Object.keys(a.doc._attachments);return Promise.all(c.map(function(c){var f=a.doc._attachments[c];if("body"in f){var d=f.body,e=f.content_type;return new Promise(function(g){ic(d,e,b,function(b){a.doc._attachments[c]=ya(C(f,["digest","content_type"]),{data:b});g()})})}}))}}))}function kc(a,b,c){function f(){--h||function(){d.length&&d.forEach(function(a){k.index("digestSeq").count(IDBKeyRange.bound(a+"::",a+"::\uffff",!1,!1)).onsuccess=
function(b){b.target.result||g["delete"](a)}})}()}var d=[],e=c.objectStore("by-sequence"),g=c.objectStore("attach-store"),k=c.objectStore("attach-seq-store"),h=a.length;a.forEach(function(a){e.index("_doc_id_rev").getKey(b+"::"+a).onsuccess=function(a){a=a.target.result;if("number"!=typeof a)return f();e["delete"](a);k.index("seq").openCursor(IDBKeyRange.only(a)).onsuccess=function(a){if(a=a.target.result){var b=a.value.digestSeq.split("::")[0];d.push(b);k["delete"](a.primaryKey);a["continue"]()}else f()}}})}
function ca(a,b,c){try{return{txn:a.transaction(b,c)}}catch(f){return{error:f}}}function fd(a,b,c,f,d,e){function g(){X=!0;k()}function k(){O&&X&&(O.docCount+=Ca,G.put(O))}function h(){Ga||(Ha.notify(f._meta.name),e(null,n))}function t(a,b,c,f,d,e,g,p){a.metadata.winningRev=b;a.metadata.deleted=c;var h=a.data;if(h._id=a.metadata.id,h._rev=a.metadata.rev,f&&(h._deleted=!0),h._attachments&&Object.keys(h._attachments).length)return function(a,b,c,f,d,e){function g(){k===h.length&&l(a,b,c,f,d,e)}function p(){k++;
g()}var k=0,h=Object.keys(a.data._attachments);h.forEach(function(c){c=a.data._attachments[c];if(c.stub)k++,g();else{var f=c.data;delete c.data;c.revpos=parseInt(b,10);var d=c.digest;q.count(d).onsuccess=function(a){if(a.target.result)return p();q.put({digest:d,body:f}).onsuccess=p}}})}(a,b,c,d,g,p);Ca+=e;k();l(a,b,c,d,g,p)}function l(a,b,c,d,e,g){function k(e){var g,k,w=a.stemmedRevs||[];d&&f.auto_compaction&&(w=w.concat((g=a.metadata,k=[],oa(g.rev_tree,function(a,b,c,f,d){"available"!==d.status||
a||(k.push(b+"-"+c),d.status="missing")}),k)));w&&w.length&&kc(w,a.metadata.id,p);t.seq=e.target.result;e=lb(t,b,c);A.put(e).onsuccess=h}function h(){n[e]={ok:!0,id:t.id,rev:t.rev};U.set(a.metadata.id,a.metadata);(function(a,b,c){function f(){++e===g.length&&c()}function d(c){c=m.put({seq:b,digestSeq:a.data._attachments[c].digest+"::"+b});c.onsuccess=f;c.onerror=function(a){a.preventDefault();a.stopPropagation();f()}}var e=0,g=Object.keys(a.data._attachments||{});if(!g.length)return c();for(var p=
0;p<g.length;p++)d(g[p])})(a,t.seq,g)}var w=a.data,t=a.metadata;w._doc_id_rev=t.id+"::"+t.rev;delete w._id;delete w._rev;var q=Y.put(w);q.onsuccess=k;q.onerror=function(a){a.preventDefault();a.stopPropagation();Y.index("_doc_id_rev").getKey(w._doc_id_rev).onsuccess=function(a){Y.put(w,a.target.result).onsuccess=k}}}var p,A,Y,q,m,G,ka,O,w=b.docs;b=0;for(var fa=w.length;b<fa;b++){var L=w[b];L._id&&pa(L._id)||(L=w[b]=dc(L,c.new_edits,a)).error&&!ka&&(ka=L)}if(ka)return e(ka);var X=!1,Ca=0,n=Array(w.length),
U=new V,Ga=!1;!function(a,b,c){function f(){e++;a.length===e&&(d?c(d):c())}if(!a.length)return c();var d,e=0;a.forEach(function(a){function c(a){d=a;++g===e.length&&f()}var e=a.data&&a.data._attachments?Object.keys(a.data._attachments):[],g=0;if(!e.length)return f();for(var p in a.data._attachments)a.data._attachments.hasOwnProperty(p)&&dd(a.data._attachments[p],b,c)})}(w,f._meta.blobSupport?"blob":"base64",function(b){if(b)return e(b);!function(){var b=ca(d,"document-store by-sequence attach-store local-store attach-seq-store meta-store".split(" "),
"readwrite");if(b.error)return e(b.error);(p=b.txn).onabort=ha(e);p.ontimeout=ha(e);p.oncomplete=h;A=p.objectStore("document-store");Y=p.objectStore("by-sequence");q=p.objectStore("attach-store");m=p.objectStore("attach-seq-store");(G=p.objectStore("meta-store")).get("meta-store").onsuccess=function(a){O=a.target.result;k()};(function(a){var b=[];if(w.forEach(function(a){a.data&&a.data._attachments&&Object.keys(a.data._attachments).forEach(function(c){c=a.data._attachments[c];c.stub&&b.push(c.digest)})}),
!b.length)return a();var c,f=0;b.forEach(function(d){var e=function(d){d&&!c&&(c=d);++f===b.length&&a(c)};q.get(d).onsuccess=function(a){a.target.result?e():(a=B(kd,"unknown stub attachment with digest "+d),a.status=412,e(a))}})})(function(b){if(b)return Ga=!0,e(b);!function(){function b(){++e===w.length&&ed(a.revs_limit,w,f,U,p,n,t,c,g)}function d(a){(a=ra(a.target.result))&&U.set(a.id,a);b()}if(w.length)for(var e=0,k=0,h=w.length;k<h;k++){var q=w[k];q._id&&pa(q._id)?b():A.get(q.metadata.id).onsuccess=
d}}()})}()})}function lc(a,b,c,f,d){function e(a){t=a.target.result;h&&d(h,t,l)}function g(a){h=a.target.result;t&&d(h,t,l)}function k(a){a=a.target.result;if(!a)return d();d([a.key],[a.value],a)}var h,t,l;-1===f&&(f=1E3);"function"==typeof a.getAll&&"function"==typeof a.getAllKeys&&1<f&&!c?(l={"continue":function(){if(!h.length)return d();var c=h[h.length-1];if(b&&b.upper)try{var k=IDBKeyRange.bound(c,b.upper,!0,b.upperOpen)}catch(Y){if("DataError"===Y.name&&0===Y.code)return d()}else k=IDBKeyRange.lowerBound(c,
!0);b=k;t=h=null;a.getAll(b,f).onsuccess=e;a.getAllKeys(b,f).onsuccess=g}},a.getAll(b,f).onsuccess=e,a.getAllKeys(b,f).onsuccess=g):c?a.openCursor(b,"prev").onsuccess=k:a.openCursor(b).onsuccess=k}function ld(a,b,c){function f(b,c){var f,d={id:c.id,key:c.id,value:{rev:b}};c.deleted?A&&(U.push(d),d.value.deleted=!0,d.doc=null):0>=Y--&&(U.push(d),a.include_docs&&(f=c.id+"::"+b,r.get(f).onsuccess=function(b){if(d.doc=Ra(b.target.result)||{},a.conflicts)b=gb(c),b.length&&(d.doc._conflicts=b);jc(d.doc,
a,G)}))}function d(a){for(var b=0,c=a.length;b<c&&U.length!==q;b++){var d=a[b];d.error&&A?U.push(d):(d=ra(d),f(d.winningRev,d))}}function e(a,b,c){c&&(d(b),U.length<q&&c["continue"]())}function g(){var b={total_rows:ka,offset:a.skip,rows:U};a.update_seq&&void 0!==O&&(b.update_seq=O);c(null,b)}var k,h,l="startkey"in a&&a.startkey,m="endkey"in a&&a.endkey,p="key"in a&&a.key,A="keys"in a&&a.keys,Y=a.skip||0,q="number"==typeof a.limit?a.limit:-1,n=!1!==a.inclusive_end;if(!A&&(h=(k=function(a,b,c,f,d){try{if(a&&
b)return d?IDBKeyRange.bound(b,a,!c,!1):IDBKeyRange.bound(a,b,!1,!c);if(a)return d?IDBKeyRange.upperBound(a):IDBKeyRange.lowerBound(a);if(b)return d?IDBKeyRange.lowerBound(b,!c):IDBKeyRange.upperBound(b,!c);if(f)return IDBKeyRange.only(f)}catch(hd){return{error:hd}}return null}(l,m,n,p,a.descending))&&k.error)&&("DataError"!==h.name||0!==h.code))return c(B(kb,h.name,h.message));l=["document-store","by-sequence","meta-store"];a.attachments&&l.push("attach-store");b=ca(b,l,"readonly");if(b.error)return c(b.error);
var G=b.txn;G.oncomplete=function(){a.attachments?mb(U,a.binary).then(g):g()};G.onabort=ha(c);var ka,O,w,fa,L,X,T=G.objectStore("document-store");b=G.objectStore("by-sequence");l=G.objectStore("meta-store");var r=b.index("_doc_id_rev"),U=[];return l.get("meta-store").onsuccess=function(a){ka=a.target.result.docCount},a.update_seq&&(w=function(a){a.target.result&&0<a.target.result.length&&(O=a.target.result[0])},b.openCursor(null,"prev").onsuccess=function(a){a=a.target.result;var b=void 0;return a&&
a.key&&(b=a.key),w({target:{result:[b]}})}),h||0===q?void 0:A?(fa=a.keys,L=Array(fa.length),X=0,void fa.forEach(function(a,b){T.get(a).onsuccess=function(c){c.target.result?L[b]=c.target.result:L[b]={key:a,error:"not_found"};++X===fa.length&&e(fa,L,{})}})):-1===q?function(a,b,c){if("function"!=typeof a.getAll){var f=[];a.openCursor(b).onsuccess=function(a){(a=a.target.result)?(f.push(a.value),a["continue"]()):c({target:{result:f}})}}else a.getAll(b).onsuccess=c}(T,k,function(b){b=b.target.result;
a.descending&&(b=b.reverse());d(b)}):void lc(T,k,a.descending,q+Y,e)}function mc(){!pb&&qb.length&&(pb=!0,qb.shift()())}function md(a,b,c,f){function e(a,b,c,f){if(c.seq!==b)return f();if(c.winningRev===a._rev)return f(c,a);G.get(a._id+"::"+c.winningRev).onsuccess=function(a){f(c,Ra(a.target.result))}}function g(){a.complete(null,{results:p,last_seq:l})}if((a=d(a)).continuous){var k=c+":"+Qa();return Ha.addListener(c,k,b,a),Ha.notify(c),{cancel:function(){Ha.removeListener(c,k)}}}var h=a.doc_ids&&
new za(a.doc_ids);a.since=a.since||0;var l=a.since,m="limit"in a?a.limit:-1;0===m&&(m=1);var n,p=[],A=0,Y=Ya(a),q=new V;b=["document-store","by-sequence"];a.attachments&&b.push("attach-store");f=ca(f,b,"readonly");if(f.error)return a.complete(f.error);(n=f.txn).onabort=ha(a.complete);n.oncomplete=function(){!a.continuous&&a.attachments?mb(p).then(g):g()};f=n.objectStore("by-sequence");var r=n.objectStore("document-store");var G=f.index("_doc_id_rev");lc(f,a.since&&!a.descending?IDBKeyRange.lowerBound(a.since,
!0):null,a.descending,m,function(b,c,f){function d(b,c){var f=a.processChange(c,b,a);l=f.seq=b.seq;var d=Y(f);return"object"==typeof d?Promise.reject(d):d?(A++,a.return_docs&&p.push(f),a.attachments&&a.include_docs?new Promise(function(b){jc(c,a,n,function(){mb([f],a.binary).then(function(){b(f)})})}):Promise.resolve(f)):Promise.resolve()}if(f&&b.length){var g=Array(b.length),k=Array(b.length),w=0;c.forEach(function(c,p){!function(a,b,c){if(h&&!h.has(a._id))return c();var f=q.get(a._id);if(f)return e(a,
b,f,c);r.get(a._id).onsuccess=function(d){f=ra(d.target.result);q.set(a._id,f);e(a,b,f,c)}}(Ra(c),b[p],function(c,e){k[p]=c;g[p]=e;++w===b.length&&function(){for(var b=[],c=0,e=g.length;c<e&&A!==m;c++){var p=g[c];p&&b.push(d(k[c],p))}Promise.all(b).then(function(b){for(var c=0,f=b.length;c<f;c++)b[c]&&a.onChange(b[c])})["catch"](a.complete);A!==m&&f["continue"]()}()})})}})}function nc(a,b){var c=this;var f=function(b){!function(a,b,c){function f(a,b){var c=a.objectStore("document-store");c.createIndex("deletedOrLocal",
"deletedOrLocal",{unique:!1});c.openCursor().onsuccess=function(a){if(a=a.target.result){var f=a.value,d=la(f);f.deletedOrLocal=d?"1":"0";c.put(f);a["continue"]()}else b()}}function d(a,b){var c=a.objectStore("local-store"),f=a.objectStore("document-store"),d=a.objectStore("by-sequence");f.openCursor().onsuccess=function(a){var e=a.target.result;if(e){var g=e.value;a=g.id;var p=pa(a);g=na(g);if(p){var k=a+"::"+g;p=a+"::";g=a+"::~";a=d.index("_doc_id_rev");p=IDBKeyRange.bound(p,g,!1,!1);var h=a.openCursor(p);
h.onsuccess=function(a){(h=a.target.result)?(a=h.value,a._doc_id_rev===k&&c.put(a),d["delete"](h.primaryKey),h["continue"]()):(f["delete"](e.primaryKey),e["continue"]())}}else e["continue"]()}else b&&b()}}function e(a,b){var c=a.objectStore("by-sequence"),f=a.objectStore("attach-store"),d=a.objectStore("attach-seq-store");f.count().onsuccess=function(a){if(!a.target.result)return b();c.openCursor().onsuccess=function(a){a=a.target.result;if(!a)return b();for(var c=a.value,f=a.primaryKey,e=Object.keys(c._attachments||
{}),g={},p=0;p<e.length;p++)g[c._attachments[e[p]].digest]=!0;c=Object.keys(g);for(p=0;p<c.length;p++)d.put({seq:f,digestSeq:c[p]+"::"+f});a["continue"]()}}}function g(a){var b=a.objectStore("by-sequence"),c=a.objectStore("document-store");c.openCursor().onsuccess=function(a){function f(){var a=lb(e,e.winningRev,e.deleted);c.put(a).onsuccess=function(){d["continue"]()}}var d=a.target.result;if(d){var e=function(a){return a.data?ra(a):(a.deleted="1"===a.deletedOrLocal,a)}(d.value);if(e.winningRev=
e.winningRev||na(e),e.seq)return f();a=e.id+"::";var g=e.id+"::\uffff";a=b.index("_doc_id_rev").openCursor(IDBKeyRange.bound(a,g));var p=0;a.onsuccess=function(a){a=a.target.result;if(!a)return e.seq=p,f();var b=a.primaryKey;p<b&&(p=b);a["continue"]()}}}}var h=b.name,q=null;a._meta=null;a._remote=!1;a.type=function(){return"idb"};a._id=K(function(b){b(null,a._meta.instanceId)});a._bulkDocs=function(c,f,d){fd(b,c,f,a,q,d)};a._get=function(a,b,c){function f(){c(g,{doc:d,metadata:e,ctx:p})}var d,e,g,
p=b.ctx;if(!p){var k=ca(q,["document-store","by-sequence","attach-store"],"readonly");if(k.error)return c(k.error);p=k.txn}p.objectStore("document-store").get(a).onsuccess=function(a){if(!(e=ra(a.target.result)))return g=B(ba,"missing"),f();if(b.rev)var c=b.latest?function(a,b){for(var c,f=b.rev_tree.slice();c=f.pop();){var d=c.pos,e=c.ids,g=e[0],p=e[1];e=e[2];var k=0===e.length;c=c.history?c.history.slice():[];if(c.push({id:g,pos:d,opts:p}),k)for(p=0,k=c.length;p<k;p++){var h=c[p];if(h.pos+"-"+h.id===
a)return d+"-"+g}g=0;for(p=e.length;g<p;g++)f.push({pos:d+1,ids:e[g],history:c})}throw Error("Unable to resolve latest revision for id "+b.id+", rev "+a);}(b.rev,e):b.rev;else if(c=e.winningRev,la(e))return g=B(ba,"deleted"),f();a=p.objectStore("by-sequence");c=e.id+"::"+c;a.index("_doc_id_rev").get(c).onsuccess=function(a){if((d=a.target.result)&&(d=Ra(d)),!d)return g=B(ba,"missing"),f();f()}}};a._getAttachment=function(a,b,c,f,d){if(f.ctx)a=f.ctx;else{a=ca(q,["document-store","by-sequence","attach-store"],
"readonly");if(a.error)return d(a.error);a=a.txn}b=c.digest;var e=c.content_type;a.objectStore("attach-store").get(b).onsuccess=function(a){ic(a.target.result.body,e,f.binary,function(a){d(null,a)})}};a._info=function(b){var c,f,d=ca(q,["meta-store","by-sequence"],"readonly");if(d.error)return b(d.error);d=d.txn;d.objectStore("meta-store").get("meta-store").onsuccess=function(a){f=a.target.result.docCount};d.objectStore("by-sequence").openCursor(null,"prev").onsuccess=function(a){c=(a=a.target.result)?
a.key:0};d.oncomplete=function(){b(null,{doc_count:f,update_seq:c,idb_attachment_format:a._meta.blobSupport?"binary":"base64"})}};a._allDocs=function(a,b){ld(a,q,b)};a._changes=function(b){return md(b,a,h,q)};a._close=function(a){q.close();Aa["delete"](h);a()};a._getRevisionTree=function(a,b){var c=ca(q,["document-store"],"readonly");if(c.error)return b(c.error);c.txn.objectStore("document-store").get(a).onsuccess=function(a){(a=ra(a.target.result))?b(null,a.rev_tree):b(B(ba))}};a._doCompaction=function(a,
b,c){var f=ca(q,["document-store","by-sequence","attach-store","attach-seq-store"],"readwrite");if(f.error)return c(f.error);var d=f.txn;d.objectStore("document-store").get(a).onsuccess=function(c){c=ra(c.target.result);oa(c.rev_tree,function(a,c,f,d,e){-1!==b.indexOf(c+"-"+f)&&(e.status="missing")});kc(b,a,d);var f=c.winningRev,e=c.deleted;d.objectStore("document-store").put(lb(c,f,e))};d.onabort=ha(c);d.oncomplete=function(){c()}};a._getLocal=function(a,b){var c=ca(q,["local-store"],"readonly");
if(c.error)return b(c.error);c=c.txn.objectStore("local-store").get(a);c.onerror=ha(b);c.onsuccess=function(a){(a=a.target.result)?(delete a._doc_id_rev,b(null,a)):b(B(ba))}};a._putLocal=function(a,b,c){"function"==typeof b&&(c=b,b={});delete a._revisions;var f=a._rev,d=a._id;a._rev=f?"0-"+(parseInt(f.split("-")[1],10)+1):"0-1";var e,g=b.ctx;if(!g){g=ca(q,["local-store"],"readwrite");if(g.error)return c(g.error);(g=g.txn).onerror=ha(c);g.oncomplete=function(){e&&c(null,e)}}var p,k=g.objectStore("local-store");
f?(p=k.get(d)).onsuccess=function(d){(d=d.target.result)&&d._rev===f?k.put(a).onsuccess=function(){e={ok:!0,id:a._id,rev:a._rev};b.ctx&&c(null,e)}:c(B(xa))}:((p=k.add(a)).onerror=function(a){c(B(xa));a.preventDefault();a.stopPropagation()},p.onsuccess=function(){e={ok:!0,id:a._id,rev:a._rev};b.ctx&&c(null,e)})};a._removeLocal=function(a,b,c){"function"==typeof b&&(c=b,b={});var f,d=b.ctx;if(!d){d=ca(q,["local-store"],"readwrite");if(d.error)return c(d.error);(d=d.txn).oncomplete=function(){f&&c(null,
f)}}var e=a._id,g=d.objectStore("local-store");d=g.get(e);d.onerror=ha(c);d.onsuccess=function(d){(d=d.target.result)&&d._rev===a._rev?(g["delete"](e),f={ok:!0,id:e,rev:"0-0"},b.ctx&&c(null,f)):c(B(ba))}};a._destroy=function(a,b){Ha.removeAllListeners(h);var c=rb.get(h);c&&c.result&&(c.result.close(),Aa["delete"](h));c=indexedDB.deleteDatabase(h);c.onsuccess=function(){rb["delete"](h);Da&&h in localStorage&&delete localStorage[h];b(null,{ok:!0})};c.onerror=ha(b)};var t=Aa.get(h);if(t)return q=t.idb,
a._meta=t.global,ia(function(){c(null,a)});t=indexedDB.open(h,5);rb.set(h,t);t.onupgradeneeded=function(a){var b=a.target.result;if(1>a.oldVersion)return function(a){var b=a.createObjectStore("document-store",{keyPath:"id"});a.createObjectStore("by-sequence",{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0});a.createObjectStore("attach-store",{keyPath:"digest"});a.createObjectStore("meta-store",{keyPath:"id",autoIncrement:!1});a.createObjectStore("detect-blob-support");b.createIndex("deletedOrLocal",
"deletedOrLocal",{unique:!1});a.createObjectStore("local-store",{keyPath:"_id"});a=a.createObjectStore("attach-seq-store",{autoIncrement:!0});a.createIndex("seq","seq");a.createIndex("digestSeq","digestSeq",{unique:!0})}(b);var c,p=a.currentTarget.transaction;3>a.oldVersion&&b.createObjectStore("local-store",{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0});4>a.oldVersion&&((c=b.createObjectStore("attach-seq-store",{autoIncrement:!0})).createIndex("seq","seq"),c.createIndex("digestSeq",
"digestSeq",{unique:!0}));var k=[f,d,e,g],h=a.oldVersion;!function T(){var a=k[h-1];h++;a&&a(p,T)}()};t.onsuccess=function(b){function f(){void 0!==p&&D&&(a._meta={name:h,instanceId:t,blobSupport:p},Aa.set(h,{idb:q,global:a._meta}),c(null,a))}function d(){if(void 0!==g&&void 0!==e){var a=h+"_id";a in e?t=e[a]:e[a]=t=Qa();e.docCount=g;A.objectStore("meta-store").put(e)}}(q=b.target.result).onversionchange=function(){q.close();Aa["delete"](h)};q.onabort=function(a){k("error","Database has a global failure",
a.target.error);q.close();Aa["delete"](h)};var e,g,p,t,l,A=q.transaction(["meta-store","detect-blob-support","document-store"],"readwrite"),D=!1;A.objectStore("meta-store").get("meta-store").onsuccess=function(a){e=a.target.result||{id:"meta-store"};d()};var m=function(a){g=a;d()};A.objectStore("document-store").index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(a){m(a.target.result)};sb||(l=A,sb=(new Promise(function(a){var b=ab([""]);b=l.objectStore("detect-blob-support").put(b,
"key");b.onsuccess=function(){var b=navigator.userAgent.match(/Chrome\/(\d+)/),c=navigator.userAgent.match(/Edge\//);a(c||!b||43<=parseInt(b[1],10))};b.onerror=l.onabort=function(b){b.preventDefault();b.stopPropagation();a(!1)}}))["catch"](function(){return!1}));sb.then(function(a){p=a;f()});A.oncomplete=function(){D=!0;f()};A.onabort=ha(c)};t.onerror=function(){k("error","Failed to open indexedDB, are you in private browsing mode?");c(B(kb,"Failed to open indexedDB, are you in private browsing mode?"))}}(c,
a,b)};var d=c.constructor;qb.push(function(){f(function(a,c){!function(a,b,c,f){try{a(b,c)}catch(p){f.emit("error",p)}}(b,a,c,d);pb=!1;ia(function(){mc()})})});mc()}function tb(a){var b=(a.doc||a.ok)._attachments;b&&Object.keys(b).forEach(function(a){a=b[a];a.data=cb(a.data,a.content_type)})}function sa(a){return/^_design/.test(a)?"_design/"+encodeURIComponent(a.slice(8)):/^_local/.test(a)?"_local/"+encodeURIComponent(a.slice(7)):encodeURIComponent(a)}function oc(a){return a._attachments&&Object.keys(a._attachments)?
Promise.all(Object.keys(a._attachments).map(function(b){var c=a._attachments[b];if(c.data&&"string"!=typeof c.data)return(new Promise(function(a){db(c.data,a)})).then(function(a){c.data=a})})):Promise.resolve()}function nd(a,b){if(b.prefix){var c=Lb(b.prefix).protocol;c="http"===c||"https"===c}else c=!1;c&&(c=b.name.substr(b.prefix.length),a=b.prefix.replace(/\/?$/,"/")+encodeURIComponent(c));c=Lb(a);(c.user||c.password)&&(c.auth={username:c.user,password:c.password});var f=c.path.replace(/(^\/|\/$)/g,
"").split("/");return c.db=f.pop(),-1===c.db.indexOf("%")&&(c.db=encodeURIComponent(c.db)),c.path=f.join("/"),c}function P(a,b){return ub(a,a.db+"/"+b)}function ub(a,b){return a.protocol+"://"+a.host+(a.port?":"+a.port:"")+"/"+a.path+(a.path?"/":"")+b}function Ta(a){return"?"+Object.keys(a).map(function(b){return b+"="+encodeURIComponent(a[b])}).join("&")}function vb(a,b){function c(a,b){return u(a,va(function(a){e().then(function(){return b.apply(this,a)})["catch"](function(b){a.pop()(b)})})).bind(h)}
function f(a,b,c){var f={};return(b=b||{}).headers=b.headers||new Ba,b.headers.get("Content-Type")||b.headers.set("Content-Type","application/json"),b.headers.get("Accept")||b.headers.set("Accept","application/json"),r(a,b).then(function(a){return f.ok=a.ok,f.status=a.status,a.json()}).then(function(a){if(f.data=a,!f.ok){f.data.status=f.status;a=ua(f.data);if(c)return c(a);throw a;}if(Array.isArray(f.data)&&(f.data=f.data.map(function(a){return a.error||a.missing?ua(a):a})),!c)return f;c(null,f.data)})}
function e(){return a.skip_setup?Promise.resolve():J||((J=f(n)["catch"](function(a){return a&&a.status&&404===a.status?(Ka(404,"PouchDB is just detecting if the remote exists."),f(n,{method:"PUT"})):Promise.reject(a)})["catch"](function(a){return!(!a||!a.status||412!==a.status)||Promise.reject(a)}))["catch"](function(){J=null}),J)}function k(a){return a.split("/").map(encodeURIComponent).join("/")}var h=this,l=nd(a.name,a),n=P(l,"");a=d(a);var J,r=function(b,c){if((c=c||{}).headers=c.headers||new Ba,
a.auth||l.auth){var f=a.auth||l.auth;f=btoa(unescape(encodeURIComponent(f.username+":"+f.password)));c.headers.set("Authorization","Basic "+f)}var d,e,g,h,p,k,t=a.headers||{};return Object.keys(t).forEach(function(a){c.headers.append(a,t[a])}),d=c,e="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",g=-1!==e.indexOf("msie"),h=-1!==e.indexOf("trident"),p=-1!==e.indexOf("edge"),k=!("method"in d)||"GET"===d.method,(g||h||p)&&k&&(b+=(-1===b.indexOf("?")?"?":"&")+"_nonce="+
Date.now()),(a.fetch||pc)(b,c)};ia(function(){b(null,h)});h._remote=!0;h.type=function(){return"http"};h.id=c("id",function(a){r(ub(l,"")).then(function(a){return a.json()}).then(function(b){b=b&&b.uuid?b.uuid+l.db:P(l,"");a(null,b)})["catch"](function(b){a(b)})});h.compact=c("compact",function(a,b){"function"==typeof a&&(b=a,a={});a=d(a);f(P(l,"_compact"),{method:"POST"}).then(function(){!function q(){h.info(function(c,f){f&&!f.compact_running?b(null,{ok:!0}):setTimeout(q,a.interval||200)})}()})});
h.bulkGet=u("bulkGet",function(a,b){function c(b){var c={};a.revs&&(c.revs=!0);a.attachments&&(c.attachments=!0);a.latest&&(c.latest=!0);f(P(l,"_bulk_get"+Ta(c)),{method:"POST",body:JSON.stringify({docs:a.docs})}).then(function(c){a.attachments&&a.binary&&c.data.results.forEach(function(a){a.docs.forEach(tb)});b(null,c.data)})["catch"](b)}function d(){function c(a){return function(c,e){h[a]=e.results;++d===f&&b(null,{results:La(h)})}}for(var f=Math.ceil(a.docs.length/50),d=0,h=Array(f),k=0;k<f;k++){var p=
C(a,["revs","attachments","binary","latest"]);p.docs=a.docs.slice(50*k,Math.min(a.docs.length,50*(k+1)));g(e,p,c(k))}}var e=this,h=ub(l,""),k=wb[h];"boolean"!=typeof k?c(function(a,c){a?(wb[h]=!1,Ka(a.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),d()):(wb[h]=!0,b(null,c))}):k?c(b):d()});h._info=function(a){e().then(function(){return r(P(l,""))}).then(function(a){return a.json()}).then(function(b){b.host=P(l,"");a(null,b)})["catch"](a)};h.fetch=function(a,b){return e().then(function(){return r(P(l,
a),b)})};h.get=c("get",function(a,b,c){function e(a){var c=a._attachments,f=c&&Object.keys(c);if(c&&f.length){var d;return d=f.map(function(f){return function(){return e=c[d=f],g=sa(a._id)+"/"+k(d)+"?rev="+a._rev,r(P(l,g)).then(function(a){return void 0===m||m.browser?a.blob():a.buffer()}).then(function(a){return b.binary?(void 0===m||m.browser||(a.type=e.content_type),a):new Promise(function(b){db(a,b)})}).then(function(a){delete e.stub;delete e.length;e.data=a});var d,e,g}}),new Promise(function(a,
b){function c(){++t===l?h?b(h):a():g()}function f(){k--;c()}function e(a){k--;h=h||a;c()}function g(){for(;5>k&&p<l;)k++,d[p++]().then(f,e)}var h,k=0,p=0,t=0,l=d.length;g()})}}"function"==typeof b&&(c=b,b={});var g={};(b=d(b)).revs&&(g.revs=!0);b.revs_info&&(g.revs_info=!0);b.latest&&(g.latest=!0);b.open_revs&&("all"!==b.open_revs&&(b.open_revs=JSON.stringify(b.open_revs)),g.open_revs=b.open_revs);b.rev&&(g.rev=b.rev);b.conflicts&&(g.conflicts=b.conflicts);b.update_seq&&(g.update_seq=b.update_seq);
a=sa(a);f(P(l,a+Ta(g))).then(function(a){return Promise.resolve().then(function(){if(b.attachments)return c=a.data,Array.isArray(c)?Promise.all(c.map(function(a){if(a.ok)return e(a.ok)})):e(c);var c}).then(function(){c(null,a.data)})})["catch"](function(b){b.docId=a;c(b)})});h.remove=c("remove",function(a,b,c,d){var e;"string"==typeof b?(e={_id:a,_rev:b},"function"==typeof c&&(d=c,c={})):(e=a,"function"==typeof b?(d=b,c={}):(d=c,c=b));a=e._rev||c.rev;f(P(l,sa(e._id))+"?rev="+a,{method:"DELETE"},d)["catch"](d)});
h.getAttachment=c("getAttachment",function(a,b,c,f){"function"==typeof c&&(f=c,c={});var d;c=c.rev?"?rev="+c.rev:"";a=P(l,sa(a))+"/"+k(b)+c;r(a,{method:"GET"}).then(function(a){if(d=a.headers.get("content-type"),a.ok)return void 0===m||m.browser?a.blob():a.buffer();throw a;}).then(function(a){void 0===m||m.browser||(a.type=d);f(null,a)})["catch"](function(a){f(a)})});h.removeAttachment=c("removeAttachment",function(a,b,c,d){f(P(l,sa(a)+"/"+k(b))+"?rev="+c,{method:"DELETE"},d)["catch"](d)});h.putAttachment=
c("putAttachment",function(a,b,c,d,e,g){"function"==typeof e&&(g=e,e=d,d=c,c=null);a=sa(a)+"/"+k(b);a=P(l,a);if(c&&(a+="?rev="+c),"string"==typeof d){try{var h=atob(d)}catch(O){return g(B(fc,"Attachment is not a valid base64 string"))}d=h?bb(h,e):""}f(a,{headers:new Ba({"Content-Type":e}),method:"PUT",body:d},g)["catch"](g)});h._bulkDocs=function(a,b,c){a.new_edits=b.new_edits;e().then(function(){return Promise.all(a.docs.map(oc))}).then(function(){return f(P(l,"_bulk_docs"),{method:"POST",body:JSON.stringify(a)},
c)})["catch"](c)};h._put=function(a,b,c){e().then(function(){return oc(a)}).then(function(){return f(P(l,sa(a._id)),{method:"PUT",body:JSON.stringify(a)})}).then(function(a){c(null,a.data)})["catch"](function(b){b.docId=a&&a._id;c(b)})};h.allDocs=c("allDocs",function(a,b){"function"==typeof a&&(b=a,a={});var c,e={},g="GET";(a=d(a)).conflicts&&(e.conflicts=!0);a.update_seq&&(e.update_seq=!0);a.descending&&(e.descending=!0);a.include_docs&&(e.include_docs=!0);a.attachments&&(e.attachments=!0);a.key&&
(e.key=JSON.stringify(a.key));a.start_key&&(a.startkey=a.start_key);a.startkey&&(e.startkey=JSON.stringify(a.startkey));a.end_key&&(a.endkey=a.end_key);a.endkey&&(e.endkey=JSON.stringify(a.endkey));void 0!==a.inclusive_end&&(e.inclusive_end=!!a.inclusive_end);void 0!==a.limit&&(e.limit=a.limit);void 0!==a.skip&&(e.skip=a.skip);e=Ta(e);void 0!==a.keys&&(g="POST",c={keys:a.keys});f(P(l,"_all_docs"+e),{method:g,body:JSON.stringify(c)}).then(function(c){a.include_docs&&a.attachments&&a.binary&&c.data.rows.forEach(tb);
b(null,c.data)})["catch"](b)});h._changes=function(a){var b="batch_size"in a?a.batch_size:25;!(a=d(a)).continuous||"heartbeat"in a||(a.heartbeat=1E4);var c="timeout"in a?a.timeout:3E4;"timeout"in a&&a.timeout&&5E3>c-a.timeout&&(c=a.timeout+5E3);"heartbeat"in a&&a.heartbeat&&5E3>c-a.heartbeat&&(c=a.heartbeat+5E3);var g={};"timeout"in a&&a.timeout&&(g.timeout=a.timeout);var h=void 0!==a.limit&&a.limit,k=h;if(a.style&&(g.style=a.style),(a.include_docs||a.filter&&"function"==typeof a.filter)&&(g.include_docs=
!0),a.attachments&&(g.attachments=!0),a.continuous&&(g.feed="longpoll"),a.seq_interval&&(g.seq_interval=a.seq_interval),a.conflicts&&(g.conflicts=!0),a.descending&&(g.descending=!0),a.update_seq&&(g.update_seq=!0),"heartbeat"in a&&a.heartbeat&&(g.heartbeat=a.heartbeat),a.filter&&"string"==typeof a.filter&&(g.filter=a.filter),a.view&&"string"==typeof a.view&&(g.filter="_view",g.view=a.view),a.query_params&&"object"==typeof a.query_params)for(var t in a.query_params)a.query_params.hasOwnProperty(t)&&
(g[t]=a.query_params[t]);var p,w="GET";a.doc_ids?(g.filter="_doc_ids",w="POST",p={doc_ids:a.doc_ids}):a.selector&&(g.filter="_selector",w="POST",p={selector:a.selector});var m,D=new od,n=function(c,d){if(!a.aborted){g.since=c;"object"==typeof g.since&&(g.since=JSON.stringify(g.since));a.descending?h&&(g.limit=k):g.limit=!h||b<k?b:k;var t=P(l,"_changes"+Ta(g)),q={signal:D.signal,method:w,body:JSON.stringify(p)};m=c;a.aborted||e().then(function(){return f(t,q,d)})["catch"](d)}},r={results:[]},J=function(c,
f){if(!a.aborted){var d=0;if(f&&f.results){d=f.results.length;r.last_seq=f.last_seq;var e=null,g=null;"number"==typeof f.pending&&(e=f.pending);"string"!=typeof r.last_seq&&"number"!=typeof r.last_seq||(g=r.last_seq);a.query_params;f.results=f.results.filter(function(b){k--;var c=Ya(a)(b);return c&&(a.include_docs&&a.attachments&&a.binary&&tb(b),a.return_docs&&r.results.push(b),a.onChange(b,e,g)),c})}else if(c)return a.aborted=!0,void a.complete(c);f&&f.last_seq&&(m=f.last_seq);d=h&&0>=k||f&&d<b||
a.descending;(!a.continuous||h&&0>=k)&&d?a.complete(null,r):ia(function(){n(m,J)})}};return n(a.since||0,J),{cancel:function(){a.aborted=!0;D.abort()}}};h.revsDiff=c("revsDiff",function(a,b,c){"function"==typeof b&&(c=b);f(P(l,"_revs_diff"),{method:"POST",body:JSON.stringify(a)},c)["catch"](c)});h._close=function(a){a()};h._destroy=function(a,b){f(P(l,""),{method:"DELETE"}).then(function(a){b(null,a)})["catch"](function(a){404===a.status?b(null,{ok:!0}):b(a)})}}function ta(a){this.status=400;this.name=
"query_parse_error";this.message=a;this.error=!0;try{Error.captureStackTrace(this,ta)}catch(b){}}function Ua(a){this.status=404;this.name="not_found";this.message=a;this.error=!0;try{Error.captureStackTrace(this,Ua)}catch(b){}}function Va(a){this.status=500;this.name="invalid_value";this.message=a;this.error=!0;try{Error.captureStackTrace(this,Va)}catch(b){}}function qc(a,b){return b&&a.then(function(a){ia(function(){b(null,a)})},function(a){ia(function(){b(a)})}),a}function xb(a,b){return function(){var c=
arguments,f=this;return a.add(function(){return b.apply(f,c)})}}function rc(a){a=new za(a);var b=Array(a.size),c=-1;return a.forEach(function(a){b[++c]=a}),b}function yb(a){var b=Array(a.size),c=-1;return a.forEach(function(a,d){b[++c]=d}),b}function sc(a){return new Va("builtin "+a+" function requires map values to be numbers or number arrays")}function zb(a){for(var b=0,c=0,f=a.length;c<f;c++){var d=a[c];if("number"!=typeof d){if(!Array.isArray(d))throw sc("_sum");b="number"==typeof b?[b]:b;for(var e=
0,g=d.length;e<g;e++){var h=d[e];if("number"!=typeof h)throw sc("_sum");void 0===b[e]?b.push(h):b[e]+=h}}else"number"==typeof b?b+=d:b[0]+=d}return b}function tc(a,b){return $a("return ("+a.replace(/;\s*$/,"")+");",{emit:b,sum:zb,log:pd,isArray:qd,toJSON:rd})}function Ia(){this.promise=new Promise(function(a){a()})}function uc(a){if(!a)return"undefined";switch(typeof a){case "function":case "string":return a.toString();default:return JSON.stringify(a)}}function vc(a,b,c,f,d,e){var g,h=uc(c)+uc(f)+
"undefined";if(!d&&(g=a._cachedViews=a._cachedViews||{})[h])return g[h];var k=a.info().then(function(k){var l=k.db_name+"-mrview-"+(d?"temp":Oa.hash(h));return Na(a,"_local/"+e,function(a){a.views=a.views||{};var c=b;-1===c.indexOf("/")&&(c=b+"/"+b);c=a.views[c]=a.views[c]||{};if(!c[l])return c[l]=!0,a}).then(function(){return a.registerDependentDatabase(l).then(function(b){b=b.db;b.auto_compaction=!0;var d={name:l,db:b,sourceDB:a,adapter:a.adapter,mapFun:c,reduceFun:f};return d.db.get("_local/lastSeq")["catch"](function(a){if(404!==
a.status)throw a;}).then(function(a){return d.seq=a?a.seq:0,g&&d.db.once("destroyed",function(){delete g[h]}),d})})})});return g&&(g[h]=k),k}function Ab(a){return-1===a.indexOf("/")?[a,a]:a.split("/")}function wc(a,b){try{a.emit("error",b)}catch(c){k("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),k("error",b)}}function xc(a,b){var c=Object.keys(b._attachments);
return Promise.all(c.map(function(c){return a.getAttachment(b._id,c,{rev:b._rev})}))}function sd(a,b,c,f){function e(b){return a.allDocs({keys:b,include_docs:!0,conflicts:!0}).then(function(a){if(f.cancelled)throw Error("cancelled");a.rows.forEach(function(a){var b,f;a.deleted||!a.doc||!/^1-/.test(a.value.rev)||(f=a.doc)._attachments&&0<Object.keys(f._attachments).length||(b=a.doc)._conflicts&&0<b._conflicts.length||(a.doc._conflicts&&delete a.doc._conflicts,g.push(a.doc),delete c[a.id])})})}c=d(c);
var g=[],h=!0;return Promise.resolve().then(function(){var a=Object.keys(c).filter(function(a){a=c[a].missing;return 1===a.length&&/^1-/.test(a[0])});if(0<a.length)return e(a)}).then(function(){var d,e,k=(d=c,e=[],Object.keys(d).forEach(function(a){d[a].missing.forEach(function(b){e.push({id:a,rev:b})})}),{docs:e,revs:!0,latest:!0});if(k.docs.length)return a.bulkGet(k).then(function(c){if(f.cancelled)throw Error("cancelled");return Promise.all(c.results.map(function(c){return Promise.all(c.docs.map(function(c){var f,
d,e=c.ok;return c.error&&(h=!1),e&&e._attachments?(f=ea(a)&&!ea(b),d=Object.keys(e._attachments),f?b.get(e._id).then(function(c){return Promise.all(d.map(function(f){return g=e,h=f,(d=c)._attachments&&d._attachments[h]&&d._attachments[h].digest===g._attachments[h].digest?b.getAttachment(c._id,f):a.getAttachment(e._id,f);var d,g,h}))})["catch"](function(b){if(404!==b.status)throw b;return xc(a,e)}):xc(a,e)).then(function(a){var b=Object.keys(e._attachments);return a.forEach(function(a,c){var f=e._attachments[b[c]];
delete f.stub;delete f.length;f.data=a}),e}):e}))})).then(function(a){g=g.concat(La(a).filter(Boolean))})})}).then(function(){return{ok:h,docs:g}})}function Bb(a,b,c,f,d){return a.get(b)["catch"](function(c){if(404===c.status)return"http"!==a.adapter&&"https"!==a.adapter||Ka(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:f,_id:b,history:[],replicator:"pouchdb",version:1};throw c;}).then(function(e){if(!d.cancelled&&e.last_seq!==c)return e.history=(e.history||[]).filter(function(a){return a.session_id!==
f}),e.history.unshift({last_seq:c,session_id:f}),e.history=e.history.slice(0,5),e.version=1,e.replicator="pouchdb",e.session_id=f,e.last_seq=c,a.put(e)["catch"](function(e){if(409===e.status)return Bb(a,b,c,f,d);throw e;})})}function Ja(a,b,c,f,d){this.src=a;this.target=b;this.id=c;this.returnValue=f;this.opts=d||{}}function Cb(a,b){var c=b[0],f=b.slice(1);return!(!a||0===b.length)&&(a===c.session_id||Cb(a,f))}function yc(a){return"number"==typeof a.status&&4===Math.floor(a.status/100)}function td(a,
b,c){var f,d=c.doc_ids?c.doc_ids.sort(S):"",e=c.filter?c.filter.toString():"",g="",h="",k="";return c.selector&&(k=JSON.stringify(c.selector)),c.filter&&c.query_params&&(g=JSON.stringify((f=c.query_params,Object.keys(f).sort(S).reduce(function(a,b){return a[b]=f[b],a},{})))),c.filter&&"_view"===c.filter&&(h=c.view.toString()),Promise.all([a.id(),b.id()]).then(function(a){var b=a[0]+a[1]+e+h+g+d+k;return new Promise(function(a){eb(b,a)})}).then(function(a){return"_local/"+a.replace(/\//g,".").replace(/\+/g,
"_")})}function zc(a,b,c,f,e){function g(){return L?Promise.resolve():td(a,b,c).then(function(d){fa=d;L=new Ja(a,b,fa,f,!1===c.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===c.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===c.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0})})}function h(){if(Sa=[],0!==w.docs.length){var a=w.docs;return b.bulkDocs({docs:a,new_edits:!1},{timeout:c.timeout}).then(function(b){if(f.cancelled)throw n(),
Error("cancelled");var c=Object.create(null);b.forEach(function(a){a.error&&(c[a.id]=a)});b=Object.keys(c).length;e.doc_write_failures+=b;e.docs_written+=a.length-b;a.forEach(function(a){var b=c[a._id];if(b){e.errors.push(b);a=(b.name||"").toLowerCase();if("unauthorized"!==a&&"forbidden"!==a)throw b;f.emit("denied",d(b))}else Sa.push(a)})},function(b){throw e.doc_write_failures+=a.length,b;})}}function k(){if(w.error)throw Error("There was a problem getting docs.");e.last_seq=ma=w.seq;var a=d(e);
return Sa.length&&(a.docs=Sa,"number"==typeof w.pending&&(a.pending=w.pending,delete w.pending),f.emit("change",a)),x=!0,L.writeCheckpoint(w.seq,ob).then(function(){if(x=!1,f.cancelled)throw n(),Error("cancelled");w=void 0;v()})["catch"](function(a){throw O(a),a;})}function l(){return sd(a,b,w.diffs,f).then(function(a){w.error=!a.ok;a.docs.forEach(function(a){delete w.diffs[a._id];e.docs_read++;w.docs.push(a)})})}function t(){var a;f.cancelled||w||(0!==X.length?(w=X.shift(),(a={},w.changes.forEach(function(b){"_user/"!==
b.id&&(a[b.id]=b.changes.map(function(a){return a.rev}))}),b.revsDiff(a).then(function(a){if(f.cancelled)throw n(),Error("cancelled");w.diffs=a})).then(l).then(h).then(k).then(t)["catch"](function(a){p("batch processing terminated with error",a)})):m(!0))}function m(a){0!==T.changes.length?(a||U||T.changes.length>=nb)&&(X.push(T),T={seq:0,changes:[],docs:[]},"pending"!==f.state&&"stopped"!==f.state||(f.state="active",f.emit("active")),t()):0!==X.length||w||((gc&&Z.live||U)&&(f.state="pending",f.emit("paused")),
U&&n())}function p(a,b){z||(b.message||(b.message=a),e.ok=!1,e.status="aborting",X=[],T={seq:0,changes:[],docs:[]},n(b))}function n(d){if(!(z||f.cancelled&&(e.status="cancelled",x)))if(e.status=e.status||"complete",e.end_time=(new Date).toISOString(),e.last_seq=ma,z=!0,d){(d=B(d)).result=e;var g=(d.name||"").toLowerCase();"unauthorized"===g||"forbidden"===g?(f.emit("error",d),f.removeAllListeners()):function(a,b,c,f){if(!1===a.retry)return b.emit("error",c),b.removeAllListeners();if("function"!=typeof a.back_off_function&&
(a.back_off_function=N),b.emit("requestError",c),"active"===b.state||"pending"===b.state){b.emit("paused",c);b.state="stopped";var d=function(){a.current_back_off=0};b.once("paused",function(){b.removeListener("active",d)});b.once("active",d)}a.current_back_off=a.current_back_off||0;a.current_back_off=a.back_off_function(a.current_back_off);setTimeout(f,a.current_back_off)}(c,f,d,function(){zc(a,b,c,f)})}else f.emit("complete",e),f.removeAllListeners()}function r(a,b,d){if(f.cancelled)return n();
"number"==typeof b&&(T.pending=b);Ya(c)(a)&&(T.seq=a.seq||d,T.changes.push(a),ia(function(){m(0===X.length&&Z.live)}))}function q(a){if(C=!1,f.cancelled)return n();if(0<a.results.length)Z.since=a.results[a.results.length-1].seq,v(),m(!0);else{var b=function(){gc?(Z.live=!0,v()):U=!0;m(!0)};w||0!==a.results.length?b():(x=!0,L.writeCheckpoint(a.last_seq,ob).then(function(){x=!1;e.last_seq=ma=a.last_seq;b()})["catch"](O))}}function u(a){if(C=!1,f.cancelled)return n();p("changes rejected",a)}function v(){function b(){e.cancel()}
function d(){f.removeListener("cancel",b)}if(!C&&!U&&X.length<gd){C=!0;f._changes&&(f.removeListener("cancel",f._abortChanges),f._changes.cancel());f.once("cancel",b);var e=a.changes(Z).on("change",r);e.then(d,d);e.then(q)["catch"](u);c.retry&&(f._changes=e,f._abortChanges=b)}}function y(){g().then(function(){if(!f.cancelled)return L.getCheckpoint().then(function(a){Z={since:ma=a,limit:nb,batch_size:nb,style:"all_docs",doc_ids:id,selector:F,return_docs:!0};c.filter&&("string"!=typeof c.filter?Z.include_docs=
!0:Z.filter=c.filter);"heartbeat"in c&&(Z.heartbeat=c.heartbeat);"timeout"in c&&(Z.timeout=c.timeout);c.query_params&&(Z.query_params=c.query_params);c.view&&(Z.view=c.view);v()});n()})["catch"](function(a){p("getCheckpoint rejected with ",a)})}function O(a){x=!1;p("writeCheckpoint completed with error",a)}var w,fa,L,X=[],T={seq:0,changes:[],docs:[]},x=!1,U=!1,z=!1,ma=0,gc=c.continuous||c.live||!1,nb=c.batch_size||100,gd=c.batches_limit||10,C=!1,id=c.doc_ids,F=c.selector,Sa=[],ob=Qa();e=e||{ok:!0,
start_time:(new Date).toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var Z={};f.ready(a,b);f.cancelled?n():(f._addedListeners||(f.once("cancel",n),"function"==typeof c.complete&&(f.once("error",c.complete),f.once("complete",function(a){c.complete(null,a)})),f._addedListeners=!0),void 0===c.since?y():g().then(function(){return x=!0,L.writeCheckpoint(c.since,ob)}).then(function(){x=!1;f.cancelled?n():(ma=c.since,y())})["catch"](O))}function Wa(){W.EventEmitter.call(this);this.cancelled=
!1;this.state="pending";var a=this,b=new Promise(function(b,f){a.once("complete",b);a.once("error",f)});a.then=function(a,f){return b.then(a,f)};a["catch"]=function(a){return b["catch"](a)};a["catch"](function(){})}function Xa(a,b){var c=b.PouchConstructor;return"string"==typeof a?new c(a,b):a}function Db(a,b,c,f){if("function"==typeof c&&(f=c,c={}),void 0===c&&(c={}),c.doc_ids&&!Array.isArray(c.doc_ids))throw B(Ma,"`doc_ids` filter parameter is not a list.");c.complete=f;(c=d(c)).continuous=c.continuous||
c.live;c.retry="retry"in c&&c.retry;c.PouchConstructor=c.PouchConstructor||this;f=new Wa(c);return zc(Xa(a,c),Xa(b,c),c,f),f}function ud(a,b,c,f){return"function"==typeof c&&(f=c,c={}),void 0===c&&(c={}),(c=d(c)).PouchConstructor=c.PouchConstructor||this,new Eb(Xa(a,c),Xa(b,c),c,f)}function Eb(a,b,c,f){function d(a){q.emit("change",{direction:"pull",change:a})}function e(a){q.emit("change",{direction:"push",change:a})}function g(a){q.emit("denied",{direction:"push",doc:a})}function h(a){q.emit("denied",
{direction:"pull",doc:a})}function k(){q.pushPaused=!0;q.pullPaused&&q.emit("paused")}function l(){q.pullPaused=!0;q.pushPaused&&q.emit("paused")}function m(){q.pushPaused=!1;q.pullPaused&&q.emit("active",{direction:"push"})}function p(){q.pullPaused=!1;q.pushPaused&&q.emit("active",{direction:"pull"})}function n(a){return function(b,c){("change"!==b||c!==d&&c!==e)&&("denied"!==b||c!==h&&c!==g)&&("paused"!==b||c!==l&&c!==k)&&("active"!==b||c!==p&&c!==m)||(b in x||(x[b]={}),x[b][a]=!0,2!==Object.keys(x[b]).length||
q.removeAllListeners(b))}}function r(a,b,c){-1==a.listeners(b).indexOf(c)&&a.on(b,c)}var q=this;this.canceled=!1;var u=c.push?ya({},c,c.push):c,v=c.pull?ya({},c,c.pull):c;this.push=Db(a,b,u);this.pull=Db(b,a,v);this.pullPaused=this.pushPaused=!0;var x={};c.live&&(this.push.on("complete",q.pull.cancel.bind(q.pull)),this.pull.on("complete",q.push.cancel.bind(q.push)));this.on("newListener",function(a){"change"===a?(r(q.pull,"change",d),r(q.push,"change",e)):"denied"===a?(r(q.pull,"denied",h),r(q.push,
"denied",g)):"active"===a?(r(q.pull,"active",p),r(q.push,"active",m)):"paused"===a&&(r(q.pull,"paused",l),r(q.push,"paused",k))});this.on("removeListener",function(a){"change"===a?(q.pull.removeListener("change",d),q.push.removeListener("change",e)):"denied"===a?(q.pull.removeListener("denied",h),q.push.removeListener("denied",g)):"active"===a?(q.pull.removeListener("active",p),q.push.removeListener("active",m)):"paused"===a&&(q.pull.removeListener("paused",l),q.push.removeListener("paused",k))});
this.pull.on("removeListener",n("pull"));this.push.on("removeListener",n("push"));var O=Promise.all([this.push,this.pull]).then(function(a){a={push:a[0],pull:a[1]};return q.emit("complete",a),f&&f(null,a),q.removeAllListeners(),a},function(a){if(q.cancel(),f?f(a):q.emit("error",a),q.removeAllListeners(),f)throw a;});this.then=function(a,b){return O.then(a,b)};this["catch"]=function(a){return O["catch"](a)}}var va=H(l(1)),ia=H(l(3)),W=l(2),da=H(l(4)),Oa=H(l(6)),Qb=H(l(7)),hc=H(l(12)),za,V,Hb=Function.prototype.toString,
Fc=Hb.call(Object);x.prototype.get=function(a){return this._store["$"+a]};x.prototype.set=function(a,b){return this._store["$"+a]=b,!0};x.prototype.has=function(a){return"$"+a in this._store};x.prototype["delete"]=function(a){a="$"+a;var b=a in this._store;return delete this._store[a],b};x.prototype.forEach=function(a){for(var b=Object.keys(this._store),c=0,f=b.length;c<f;c++){var d=b[c];a(this._store[d],d.substring(1))}};Object.defineProperty(x.prototype,"size",{get:function(){return Object.keys(this._store).length}});
r.prototype.add=function(a){return this._store.set(a,!0)};r.prototype.has=function(a){return this._store.has(a)};r.prototype.forEach=function(a){this._store.forEach(function(b,c){a(c)})};Object.defineProperty(r.prototype,"size",{get:function(){return this._store.size}});(function(){$jscomp.initSymbol();if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;$jscomp.initSymbol();var a=Object.getOwnPropertyDescriptor(Map,Symbol.species);$jscomp.initSymbol();return a&&
"get"in a&&Map[Symbol.species]===Map})()?(za=Set,V=Map):(za=r,V=x);try{localStorage.setItem("_pouch_check_localstorage",1);var Da=!!localStorage.getItem("_pouch_check_localstorage")}catch(a){Da=!1}da(e,W.EventEmitter);e.prototype.addListener=function(a,b,c,f){function d(){if(e._listeners[b])if(g)g="waiting";else{g=!0;var a=C(f,"style include_docs attachments conflicts filter doc_ids view since query_params binary return_docs".split(" "));c.changes(a).on("change",function(a){a.seq>f.since&&!f.cancelled&&
(f.since=a.seq,f.onChange(a))}).on("complete",function(){"waiting"===g&&ia(d);g=!1}).on("error",function(){g=!1})}}if(!this._listeners[b]){var e=this,g=!1;this._listeners[b]=d;this.on(a,d)}};e.prototype.removeListener=function(a,b){b in this._listeners&&(W.EventEmitter.prototype.removeListener.call(this,a,this._listeners[b]),delete this._listeners[b])};e.prototype.notifyLocalWindows=function(a){Da&&(localStorage[a]="a"===localStorage[a]?"b":"a")};e.prototype.notify=function(a){this.emit(a);this.notifyLocalWindows(a)};
var ya="function"==typeof Object.assign?Object.assign:function(a){for(var b=Object(a),c=1;c<arguments.length;c++){var f=arguments[c];if(null!=f)for(var d in f)Object.prototype.hasOwnProperty.call(f,d)&&(b[d]=f[d])}return b};da(I,Error);I.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};new I(401,"unauthorized","Name or password is incorrect.");var vd=new I(400,"bad_request","Missing JSON list of 'docs'"),ba=new I(404,
"not_found","missing"),xa=new I(409,"conflict","Document update conflict"),Jb=new I(400,"bad_request","_id field must contain a string"),Ic=new I(412,"missing_id","_id is required for puts"),Hc=new I(400,"bad_request","Only reserved document ids may start with underscore."),Ib=(new I(412,"precondition_failed","Database not open"),new I(500,"unknown_error","Database encountered an unknown error")),fc=new I(500,"badarg","Some query argument is invalid"),wd=(new I(400,"invalid_request","Request was invalid"),
new I(400,"query_parse_error","Some query parameter is invalid")),ec=new I(500,"doc_validation","Bad special document member"),Ma=new I(400,"bad_request","Something wrong with the request"),Fb=new I(400,"bad_request","Document must be a JSON object"),kb=(new I(404,"not_found","Database not found"),new I(500,"indexed_db_went_bad","unknown")),cc=(new I(500,"web_sql_went_bad","unknown"),new I(500,"levelDB_went_went_bad","unknown"),new I(403,"forbidden","Forbidden by design doc validate_doc_update function"),
new I(400,"bad_request","Invalid rev format")),kd=(new I(412,"file_exists","The database could not be created, the file already exists."),new I(412,"missing_stub","A pre-existing attachment stub wasn't found"));new I(413,"invalid_url","Provided URL is invalid");var Mb="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),Kc=/(?:^|&)([^&=]*)=?([^&]*)/g,Jc=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
Nc=v.setImmediate||v.setTimeout,Qa=Qb.v4;da(Ea,W.EventEmitter);Ea.prototype.cancel=function(){this.isCancelled=!0;this.db.taskqueue.isReady&&this.emit("cancel")};Ea.prototype.validateChanges=function(a){var b=a.complete,c=this;z._changesFilterPlugin?z._changesFilterPlugin.validate(a,function(f){if(f)return b(f);c.doChanges(a)}):c.doChanges(a)};Ea.prototype.doChanges=function(a){var b=this,c=a.complete;if("live"in(a=d(a))&&!("continuous"in a)&&(a.continuous=a.live),a.processChange=Sc,"latest"===a.since&&
(a.since="now"),a.since||(a.since=0),"now"!==a.since){if(z._changesFilterPlugin){if(z._changesFilterPlugin.normalize(a),z._changesFilterPlugin.shouldFilter(this,a))return z._changesFilterPlugin.filter(this,a)}else["doc_ids","filter","selector","view"].forEach(function(b){b in a&&k("warn",'The "'+b+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in a||(a.descending=!1);
a.limit=0===a.limit?1:a.limit;a.complete=c;var f=this.db._changes(a);if(f&&"function"==typeof f.cancel){var e=b.cancel;b.cancel=va(function(a){f.cancel();e.apply(this,a)})}}else this.db.info().then(function(f){b.isCancelled?c(null,{status:"cancelled"}):(a.since=f.update_seq,b.doChanges(a))},c)};da(M,W.EventEmitter);M.prototype.post=u("post",function(a,b,c){if("function"==typeof b&&(c=b,b={}),"object"!=typeof a||Array.isArray(a))return c(B(Fb));this.bulkDocs({docs:[a]},b,hb(c,a._id))});M.prototype.put=
u("put",function(a,b,c){function f(c){"function"==typeof k._put&&!1!==b.new_edits?k._put(a,b,c):k.bulkDocs({docs:[a]},b,hb(c,a._id))}if("function"==typeof b&&(c=b,b={}),"object"!=typeof a||Array.isArray(a))return c(B(Fb));if(Gb(a._id),pa(a._id)&&"function"==typeof this._putLocal)return a._deleted?this._removeLocal(a,c):this._putLocal(a,c);var d,e,g,h,k=this;b.force&&a._rev?(d=a._rev.split("-"),e=d[1],g=parseInt(d[0],10)+1,h=Pb(),a._revisions={start:g,ids:[h,e]},a._rev=g+"-"+h,b.new_edits=!1,f(function(b){c(b,
b?null:{ok:!0,id:a._id,rev:a._rev})})):f(c)});M.prototype.putAttachment=u("putAttachment",function(a,b,c,f,d){function e(a){var c="_rev"in a?parseInt(a._rev,10):0;return a._attachments=a._attachments||{},a._attachments[b]={content_type:d,data:f,revpos:++c},g.put(a)}var g=this;return"function"==typeof d&&(d=f,f=c,c=null),void 0===d&&(d=f,f=c,c=null),d||k("warn","Attachment",b,"on document",a,"is missing content_type"),g.get(a).then(function(a){if(a._rev!==c)throw B(xa);return e(a)},function(b){if(b.reason===
ba.message)return e({_id:a});throw b;})});M.prototype.removeAttachment=u("removeAttachment",function(a,b,c,f){var d=this;d.get(a,function(a,e){if(a)f(a);else if(e._rev===c){if(!e._attachments)return f();delete e._attachments[b];0===Object.keys(e._attachments).length&&delete e._attachments;d.put(e,f)}else f(B(xa))})});M.prototype.remove=u("remove",function(a,b,c,d){var f;"string"==typeof b?(f={_id:a,_rev:b},"function"==typeof c&&(d=c,c={})):(f=a,"function"==typeof b?(d=b,c={}):(d=c,c=b));(c=c||{}).was_delete=
!0;a={_id:f._id,_rev:f._rev||c.rev,_deleted:!0};if(pa(a._id)&&"function"==typeof this._removeLocal)return this._removeLocal(f,d);this.bulkDocs({docs:[a]},c,hb(d,a._id))});M.prototype.revsDiff=u("revsDiff",function(a,b,c){function d(a,b){h.has(a)||h.set(a,{missing:[]});h.get(a).missing.push(b)}"function"==typeof b&&(c=b,b={});var e=Object.keys(a);if(!e.length)return c(null,{});var g=0,h=new V;e.map(function(b){this._getRevisionTree(b,function(f,k){if(f&&404===f.status&&"missing"===f.message)h.set(b,
{missing:a[b]});else{if(f)return c(f);var l=k;var p=a[t=b].slice(0);oa(l,function(a,b,c,f,e){a=b+"-"+c;b=p.indexOf(a);-1!==b&&(p.splice(b,1),"available"!==e.status&&d(t,a))});p.forEach(function(a){d(t,a)})}var t;if(++g===e.length){var m={};return h.forEach(function(a,b){m[b]=a}),c(null,m)}})},this)});M.prototype.bulkGet=u("bulkGet",function(a,b){g(this,a,b)});M.prototype.compactDocument=u("compactDocument",function(a,b,c){var d=this;this._getRevisionTree(a,function(f,e){if(f)return c(f);var g,h,k=
(g={},h=[],oa(e,function(a,b,c,d){b=b+"-"+c;return a&&(g[b]=0),void 0!==d&&h.push({from:d,to:b}),b}),h.reverse(),h.forEach(function(a){void 0===g[a.from]?g[a.from]=1+g[a.to]:g[a.from]=Math.min(g[a.from],1+g[a.to])}),g),l=[],t=[];Object.keys(k).forEach(function(a){k[a]>b&&l.push(a)});oa(e,function(a,b,c,d,f){a=b+"-"+c;"available"===f.status&&-1!==l.indexOf(a)&&t.push(a)});d._doCompaction(a,t,c)})});M.prototype.compact=u("compact",function(a,b){"function"==typeof a&&(b=a,a={});a=a||{};this._compactionQueue=
this._compactionQueue||[];this._compactionQueue.push({opts:a,callback:b});1===this._compactionQueue.length&&function t(a){var b=a._compactionQueue[0],d=b.opts,f=b.callback;a.get("_local/compaction")["catch"](function(){return!1}).then(function(b){b&&b.last_seq&&(d.last_seq=b.last_seq);a._compact(d,function(b,d){b?f(b):f(null,d);ia(function(){a._compactionQueue.shift();a._compactionQueue.length&&t(a)})})})}(this)});M.prototype._compact=function(a,b){var c=this,d=[];c.changes({return_docs:!1,last_seq:a.last_seq||
0}).on("change",function(a){d.push(c.compactDocument(a.id,0))}).on("complete",function(a){var f=a.last_seq;Promise.all(d).then(function(){return Na(c,"_local/compaction",function(a){return(!a.last_seq||a.last_seq<f)&&(a.last_seq=f,a)})}).then(function(){b(null,{ok:!0})})["catch"](b)}).on("error",b)};M.prototype.get=u("get",function(a,b,c){function d(){var d=[],f=e.length;if(!f)return c(null,d);e.forEach(function(e){g.get(a,{rev:e,revs:b.revs,latest:b.latest,attachments:b.attachments,binary:b.binary},
function(a,b){if(a)d.push({missing:e});else{for(var g,h=0,k=d.length;h<k;h++)if(d[h].ok&&d[h].ok._rev===b._rev){g=!0;break}g||d.push({ok:b})}--f||c(null,d)})})}if("function"==typeof b&&(c=b,b={}),"string"!=typeof a)return c(B(Jb));if(pa(a)&&"function"==typeof this._getLocal)return this._getLocal(a,c);var e=[],g=this;if(!b.open_revs)return this._get(a,b,function(d,f){if(d)return d.docId=a,c(d);var e=f.doc,h=f.metadata,k=f.ctx;if(b.conflicts){var l=gb(h);l.length&&(e._conflicts=l)}if(la(h,e._rev)&&
(e._deleted=!0),b.revs||b.revs_info){var t=e._rev.split("-");l=parseInt(t[0],10);t=t[1];var m=Rb(h.rev_tree);h=null;for(var n=0;n<m.length;n++){var r=m[n],O=r.ids.map(function(a){return a.id}).indexOf(t);(O===l-1||!h&&-1!==O)&&(h=r)}l=h.ids.map(function(a){return a.id}).indexOf(e._rev.split("-")[1])+1;if(h.ids.splice(l,h.ids.length-l),h.ids.reverse(),b.revs&&(e._revisions={start:h.pos+h.ids.length-1,ids:h.ids.map(function(a){return a.id})}),b.revs_info){var w=h.pos+h.ids.length;e._revs_info=h.ids.map(function(a){return{rev:--w+
"-"+a.id,status:a.opts.status}})}}if(b.attachments&&e._attachments){var u=e._attachments,L=Object.keys(u).length;if(0===L)return c(null,e);Object.keys(u).forEach(function(a){this._getAttachment(e._id,a,u[a],{rev:e._rev,binary:b.binary,ctx:k},function(b,d){var f=e._attachments[a];f.data=d;delete f.stub;delete f.length;--L||c(null,e)})},g)}else{if(e._attachments)for(var v in e._attachments)e._attachments.hasOwnProperty(v)&&(e._attachments[v].stub=!0);c(null,e)}});if("all"===b.open_revs)this._getRevisionTree(a,
function(a,b){if(a)return c(a);e=fb(b).map(function(a){return a.rev});d()});else{if(!Array.isArray(b.open_revs))return c(B(Ib,"function_clause"));e=b.open_revs;for(var h=0;h<e.length;h++){var k=e[h];if("string"!=typeof k||!/^\d+-/.test(k))return c(B(cc))}d()}});M.prototype.getAttachment=u("getAttachment",function(a,b,c,d){var f=this;c instanceof Function&&(d=c,c={});this._get(a,c,function(e,g){return e?d(e):g.doc._attachments&&g.doc._attachments[b]?(c.ctx=g.ctx,c.binary=!0,void f._getAttachment(a,
b,g.doc._attachments[b],c,d)):d(B(ba))})});M.prototype.allDocs=u("allDocs",function(a,b){if("function"==typeof a&&(b=a,a={}),a.skip=void 0!==a.skip?a.skip:0,a.start_key&&(a.startkey=a.start_key),a.end_key&&(a.endkey=a.end_key),"keys"in a){if(!Array.isArray(a.keys))return b(new TypeError("options.keys must be an array"));var c=["startkey","endkey","key"].filter(function(b){return b in a})[0];if(c)return void b(B(wd,"Query parameter `"+c+"` is not compatible with multi-get"));if(!ea(this)&&(e="limit"in
(d=a)?d.keys.slice(d.skip,d.limit+d.skip):0<d.skip?d.keys.slice(d.skip):d.keys,d.keys=e,d.skip=0,delete d.limit,d.descending&&(e.reverse(),d.descending=!1),0===a.keys.length))return this._allDocs({limit:0},b)}var d,e;return this._allDocs(a,b)});M.prototype.changes=function(a,b){return"function"==typeof a&&(b=a,a={}),(a=a||{}).return_docs="return_docs"in a?a.return_docs:!a.live,new Ea(this,a,b)};M.prototype.close=u("close",function(a){return this._closed=!0,this.emit("closed"),this._close(a)});M.prototype.info=
u("info",function(a){var b=this;this._info(function(c,d){if(c)return a(c);d.db_name=d.db_name||b.name;d.auto_compaction=!(!b.auto_compaction||ea(b));d.adapter=b.adapter;a(null,d)})});M.prototype.id=u("id",function(a){return this._id(a)});M.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter};M.prototype.bulkDocs=u("bulkDocs",function(a,b,c){if("function"==typeof b&&(c=b,b={}),b=b||{},Array.isArray(a)&&(a={docs:a}),!a||!a.docs||!Array.isArray(a.docs))return c(B(vd));
for(var d=0;d<a.docs.length;++d)if("object"!=typeof a.docs[d]||Array.isArray(a.docs[d]))return c(B(Fb));var e;if(a.docs.forEach(function(a){a._attachments&&Object.keys(a._attachments).forEach(function(b){e=e||"_"===b.charAt(0)&&b+" is not a valid attachment name, attachment names cannot start with '_'";a._attachments[b].content_type||k("warn","Attachment",b,"on document",a._id,"is missing content_type")})}),e)return c(B(Ma,e));"new_edits"in b||(b.new_edits=!("new_edits"in a)||a.new_edits);var g=this;
b.new_edits||ea(g)||a.docs.sort(Tc);(function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c._deleted)delete c._attachments;else if(c._attachments)for(var d=Object.keys(c._attachments),f=0;f<d.length;f++){var e=d[f];c._attachments[e]=C(c._attachments[e],"data digest content_type length revpos stub".split(" "))}}})(a.docs);var h=a.docs.map(function(a){return a._id});return this._bulkDocs(a,b,function(a,d){if(a)return c(a);if(b.new_edits||(d=d.filter(function(a){return a.error})),!ea(g))for(var f=0,
e=d.length;f<e;f++)d[f].id=d[f].id||h[f];c(null,d)})});M.prototype.registerDependentDatabase=u("registerDependentDatabase",function(a,b){var c=new this.constructor(a,this.__opts);Na(this,"_local/_pouch_dependentDbs",function(b){return b.dependentDbs=b.dependentDbs||{},!b.dependentDbs[a]&&(b.dependentDbs[a]=!0,b)}).then(function(){b(null,{db:c})})["catch"](b)});M.prototype.destroy=u("destroy",function(a,b){function c(){d._destroy(a,function(a,c){if(a)return b(a);d._destroyed=!0;d.emit("destroyed");
b(null,c||{ok:!0})})}"function"==typeof a&&(b=a,a={});var d=this,e=!("use_prefix"in d)||d.use_prefix;if(ea(d))return c();d.get("_local/_pouch_dependentDbs",function(a,f){if(a)return 404!==a.status?b(a):c();var g=d.constructor,h=Object.keys(f.dependentDbs).map(function(a){a=e?a.replace(new RegExp("^"+g.prefix),""):a;return(new g(a,d.__opts)).destroy()});Promise.all(h).then(c,b)})});Fa.prototype.execute=function(){var a;if(this.failed)for(;a=this.queue.shift();)a(this.failed);else for(;a=this.queue.shift();)a()};
Fa.prototype.fail=function(a){this.failed=a;this.execute()};Fa.prototype.ready=function(a){this.isReady=!0;this.db=a;this.execute()};Fa.prototype.addTask=function(a){this.queue.push(a);this.failed&&this.execute()};da(z,M);var od="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},pc=fetch,Ba=Headers;z.adapters={};z.preferredAdapters=[];z.prefix="_pouch_";var Ac=new W.EventEmitter;!function(a){Object.keys(W.EventEmitter.prototype).forEach(function(b){"function"==
typeof W.EventEmitter.prototype[b]&&(a[b]=Ac[b].bind(Ac))});var b=a._destructionListeners=new V;a.on("ref",function(a){b.has(a.name)||b.set(a.name,[]);b.get(a.name).push(a)});a.on("unref",function(a){if(b.has(a.name)){var c=b.get(a.name),d=c.indexOf(a);0>d||(c.splice(d,1),1<c.length?b.set(a.name,c):b["delete"](a.name))}});a.on("destroyed",function(a){if(b.has(a)){var c=b.get(a);b["delete"](a);c.forEach(function(a){a.emit("destroyed",!0)})}})}(z);z.adapter=function(a,b,c){b.valid()&&(z.adapters[a]=
b,c&&z.preferredAdapters.push(a))};z.plugin=function(a){if("function"==typeof a)a(z);else{if("object"!=typeof a||0===Object.keys(a).length)throw Error('Invalid plugin: got "'+a+'", expected an object or a function');Object.keys(a).forEach(function(b){z.prototype[b]=a[b]})}return this.__defaults&&(z.__defaults=ya({},this.__defaults)),z};z.defaults=function(a){function b(a,d){if(!(this instanceof b))return new b(a,d);d=d||{};a&&"object"==typeof a&&(a=(d=a).name,delete d.name);d=ya({},b.__defaults,d);
z.call(this,a,d)}return da(b,z),b.preferredAdapters=z.preferredAdapters.slice(),Object.keys(z).forEach(function(a){a in b||(b[a]=z[a])}),b.__defaults=ya({},this.__defaults,a),b};z.fetch=function(a,b){return pc(a,b)};var Yb=["$or","$nor","$not"],Zb={$elemMatch:function(a,b,c,d){return!!Array.isArray(d)&&0!==d.length&&("object"==typeof d[0]?d.some(function(a){return wa(a,b,Object.keys(b))}):d.some(function(d){return jb(b,a,c,d)}))},$allMatch:function(a,b,c,d){return!!Array.isArray(d)&&0!==d.length&&
("object"==typeof d[0]?d.every(function(a){return wa(a,b,Object.keys(b))}):d.every(function(d){return jb(b,a,c,d)}))},$eq:function(a,b,c,d){return void 0!==d&&0===S(d,b)},$gte:function(a,b,c,d){return void 0!==d&&0<=S(d,b)},$gt:function(a,b,c,d){return void 0!==d&&0<S(d,b)},$lte:function(a,b,c,d){return void 0!==d&&0>=S(d,b)},$lt:function(a,b,c,d){return void 0!==d&&0>S(d,b)},$exists:function(a,b,c,d){return b?void 0!==d:void 0===d},$mod:function(a,b,c,d){if(a=null!=d){a=b[0];b=b[1];if(0===a)throw Error("Bad divisor, cannot divide by zero");
if(parseInt(a,10)!==a)throw Error("Divisor is not an integer");if(parseInt(b,10)!==b)throw Error("Modulus is not an integer");a=parseInt(d,10)===d&&d%a===b}return a},$ne:function(a,b,c,d){return b.every(function(a){return 0!==S(d,a)})},$in:function(a,b,c,d){return null!=d&&$b(d,b)},$nin:function(a,b,c,d){return null!=d&&!$b(d,b)},$size:function(a,b,c,d){return null!=d&&(e=b,d.length===e);var e},$all:function(a,b,c,d){return Array.isArray(d)&&(e=d,b.every(function(a){return-1<e.indexOf(a)}));var e},
$regex:function(a,b,c,d){return null!=d&&(e=d,(new RegExp(b)).test(e));var e},$type:function(a,b,c,d){return function(a,b){switch(b){case "null":return null===a;case "boolean":return"boolean"==typeof a;case "number":return"number"==typeof a;case "string":return"string"==typeof a;case "array":return a instanceof Array;case "object":return"[object Object]"==={}.toString.call(a)}throw Error(b+" not supported as a type.Please use one of object, string, array, number, boolean or null.");}(d,b)}};z.plugin(function(a){a._changesFilterPlugin=
{validate:Xc,normalize:Yc,shouldFilter:Zc,filter:$c}});z.version="7.0.0";var ad=ac("_id _rev _attachments _deleted _revisions _revs_info _conflicts _deleted_conflicts _local_seq _rev_tree _replication_id _replication_state _replication_state_time _replication_state_reason _replication_stats _removed".split(" ")),bd=ac("_attachments _replication_id _replication_state _replication_state_time _replication_state_reason _replication_stats".split(" ")),Ha=new e,pb=!1,qb=[],sb,Aa=new V,rb=new V;nc.valid=
function(){return"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var wb={};vb.valid=function(){return!0};da(ta,Error);da(Ua,Error);da(Va,Error);var pd=k.bind(null,"log"),qd=Array.isArray,rd=JSON.parse;Ia.prototype.add=function(a){return this.promise=this.promise["catch"](function(){}).then(function(){return a()}),this.promise};Ia.prototype.finish=function(){return this.promise};var Bc={},Cc=new Ia,xd=function(a,b){return zb(b)},yd=function(a,b){return b.length},zd=function(a,b){for(var c=
zb(b),d=Math.min.apply(null,b),e=Math.max.apply(null,b),g=b.length,h=0,k=0,l=b.length;k<l;k++){var m=b[k];h+=m*m}return{sum:c,min:d,max:e,count:g,sumsqr:h}},Dc=function(a,b,c,d){function e(a,b,c,d,e){try{return{output:b(c,d,e)}}catch(T){return wc(a,T),{error:T}}}function f(a,b){var c=S(a.key,b.key);return 0!==c?c:S(a.value,b.value)}function g(a){var b=a.value;return b&&"object"==typeof b&&b._id||a.id}function h(a){return function(b){return a.include_docs&&a.attachments&&a.binary&&b.rows.forEach(function(a){var b=
a.doc&&a.doc._attachments;b&&Object.keys(b).forEach(function(a){var c=b[a];b[a].data=cb(c.data,c.content_type)})}),b}}function k(a,b,c,d){b=b[a];void 0!==b&&(d&&(b=encodeURIComponent(JSON.stringify(b))),c.push(a+"="+b))}function l(a){if(void 0!==a){var b=Number(a);return isNaN(b)||b!==parseInt(a,10)?a:b}}function m(a,b){var c=a.descending?"endkey":"startkey",d=a.descending?"startkey":"endkey";if(void 0!==a[c]&&void 0!==a[d]&&0<S(a[c],a[d]))throw new ta("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");
if(b.reduce&&!1!==a.reduce){if(a.include_docs)throw new ta("{include_docs:true} is invalid for reduce");if(a.keys&&1<a.keys.length&&!a.group&&!a.group_level)throw new ta("Multi-key fetches for reduce views must use {group: true}");}["group_level","limit","skip"].forEach(function(b){a:{if(b=a[b]){if("number"!=typeof b){b=new ta('Invalid value for integer: "'+b+'"');break a}if(0>b){b=new ta('Invalid value for positive integer: "'+b+'"');break a}}b=void 0}if(b)throw b;})}function n(a){return function(b){if(404===
b.status)return a;throw b;}}function r(a,b,c){var d,e="_local/doc_"+a,f={_id:e,keys:[]};a=c.get(a);var g=a[0];return(1===(d=a[1]).length&&/^1-/.test(d[0].rev)?Promise.resolve(f):b.db.get(e)["catch"](n(f))).then(function(a){return(c=a,c.keys.length?b.db.allDocs({keys:c.keys,include_docs:!0}):Promise.resolve({rows:[]})).then(function(b){return function(a,b){for(var c=[],d=new za,e=0,f=b.rows.length;e<f;e++){var h=b.rows[e].doc;if(h&&(c.push(h),d.add(h._id),h._deleted=!g.has(h._id),!h._deleted)){var k=
g.get(h._id);"value"in k&&(h.value=k.value)}}e=yb(g);return e.forEach(function(a){if(!d.has(a)){var b={_id:a};a=g.get(a);"value"in a&&(b.value=a.value);c.push(b)}}),a.keys=rc(e.concat(a.keys)),c.push(a),c}(a,b)});var c})}function u(a){a="string"==typeof a?a:a.name;var b=Bc[a];return b||(b=Bc[a]=new Ia),b}function q(a){return xb(u(a),function(){return function(a){function c(b,c){return function(){return e=b,f=c,g="_local/lastSeq",(d=a).db.get(g)["catch"](n({_id:g,seq:0})).then(function(a){var b=yb(e);
return Promise.all(b.map(function(a){return r(a,d,e)})).then(function(b){b=La(b);return a.seq=f,b.push(a),d.db.bulkDocs({docs:b})})});var d,e,f,g}}function d(){return a.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:l,limit:50}).then(e)}function e(b){b=b.results;if(b.length){for(var e=new V,n=0,p=b.length;n<p;n++){var q=b[n];if("_"!==q.doc._id[0]){g=[];if(!(h=q.doc)._deleted){var r=a.sourceDB;try{k(h)}catch(jd){wc(r,jd)}}g.sort(f);r=void 0;for(var t=g,w=new V,
u=0,v=t.length;u<v;u++){var L=t[u],x=[L.key,L.id];0<u&&0===S(L.key,r)&&x.push(u);w.set(aa(x),L);r=L.key}e.set(q.doc._id,[w,q.changes])}l=q.seq}if(m.add(c(e,l)),!(50>b.length))return d()}}var g,h,k=b(a.mapFun,function(a,b){var c={id:h._id,key:qa(a)};null!=b&&(c.value=qa(b));g.push(c)}),l=a.seq||0,m=new Ia;return d().then(function(){return m.finish()}).then(function(){a.seq=l})}(a)})()}function v(a,b){return xb(u(a),function(){return function(a,b){function d(b){return b.include_docs=!0,a.db.allDocs(b).then(function(a){return h=
a.total_rows,a.rows.map(function(a){if("value"in a.doc&&"object"==typeof a.doc.value&&null!==a.doc.value){var b=Object.keys(a.doc.value).sort(),c=["id","key","value"];if(!(b<c||c<b))return a.doc.value}a:{b=a.doc._id;c=[];for(var d=[],e=0;;){var f=b[e++];if("\x00"!==f)switch(f){case "1":c.push(null);break;case "2":c.push("1"===b[e]);e++;break;case "3":var g=b;var h=f=e;if("1"===g[f])g=0,f++;else{var k="0"===g[f];f++;var l="",m=g.substring(f,f+3);m=parseInt(m,10)+-324;k&&(m=-m);for(f+=3;;){var n=g[f];
if("\x00"===n)break;l+=n;f++}g=1===(l=l.split(".")).length?parseInt(l,10):parseFloat(l[0]+"."+l[1]);k&&(g-=10);0!==m&&(g=parseFloat(g+"e"+m))}k=g;f-=h;c.push(k);e+=f;break;case "4":for(f="";;){h=b[e];if("\x00"===h)break;f+=h;e++}f=f.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"\u0001").replace(/\u0002\u0002/g,"\u0002");c.push(f);break;case "5":f={element:[],index:c.length};c.push(f.element);d.push(f);break;case "6":f={element:{},index:c.length};c.push(f.element);d.push(f);break;default:throw Error("bad collationIndex or unexpectedly reached end of input: "+
f);}else{if(1===c.length){b=c.pop();break a}f=c;l=d;h=f.pop();l.length&&(k=l[l.length-1],h===k.element&&(l.pop(),k=l[l.length-1]),l=k.element,k=k.index,Array.isArray(l)?l.push(h):k===f.length-2?l[f.pop()]=h:f.push(h))}}}return{key:b[0],id:b[1],value:"value"in a.doc?a.doc.value:null}})})}function f(d){var f;if(f=k?function(a,b,d){0===d.group_level&&delete d.group_level;var f,g,h,k=d.group||d.group_level,l=c(a.reduceFun),m=[],n=isNaN(d.group_level)?Number.POSITIVE_INFINITY:d.group_level;b.forEach(function(a){var b=
m[m.length-1],c=k?a.key:null;if(k&&Array.isArray(c)&&(c=c.slice(0,n)),b&&0===S(b.groupKey,c))return b.keys.push([a.key,a.id]),void b.values.push(a.value);m.push({keys:[[a.key,a.id]],values:[a.value],groupKey:c})});b=[];for(var p=0,q=m.length;p<q;p++){var r=m[p],t=e(a.sourceDB,l,r.keys,r.values,!1);if(t.error&&t.error instanceof Va)throw t.error;b.push({value:t.error?null:t.output,key:r.groupKey})}return{rows:(f=b,g=d.limit,h=d.skip,h=h||0,"number"==typeof g?f.slice(h,g+h):0<h?f.slice(h):f)}}(a,d,
b):{total_rows:h,offset:l,rows:d},b.update_seq&&(f.update_seq=a.seq),b.include_docs){var m=rc(d.map(g));return a.sourceDB.allDocs({keys:m,include_docs:!0,conflicts:b.conflicts,attachments:b.attachments,binary:b.binary}).then(function(a){var b=new V;return a.rows.forEach(function(a){b.set(a.id,a.doc)}),d.forEach(function(a){var c=g(a);(c=b.get(c))&&(a.doc=c)}),f})}return f}var h,k=a.reduceFun&&!1!==b.reduce,l=b.skip||0;if(void 0===b.keys||b.keys.length||(b.limit=0,delete b.keys),void 0!==b.keys){var m=
b.keys.map(function(a){a={startkey:aa([a]),endkey:aa([a,{}])};return b.update_seq&&(a.update_seq=!0),d(a)});return Promise.all(m).then(La).then(f)}var n,p;m={descending:b.descending};if(b.update_seq&&(m.update_seq=!0),"start_key"in b&&(n=b.start_key),"startkey"in b&&(n=b.startkey),"end_key"in b&&(p=b.end_key),"endkey"in b&&(p=b.endkey),void 0!==n&&(m.startkey=b.descending?aa([n,{}]):aa([n])),void 0!==p)n=!1!==b.inclusive_end,b.descending&&(n=!n),m.endkey=aa(n?[p,{}]:[p]);void 0!==b.key&&(p=aa([b.key]),
n=aa([b.key,{}]),m.descending?(m.endkey=p,m.startkey=n):(m.startkey=p,m.endkey=n));return k||("number"==typeof b.limit&&(m.limit=b.limit),m.skip=l),d(m).then(f)}(a,b)})()}function x(b,c,e){if("function"==typeof b._query)return f=b,g=c,l=e,new Promise(function(a,b){f._query(g,l,function(c,d){if(c)return b(c);a(d)})});var f,g,l;if(ea(b))return function(a,b,c){var d,e,f,g=[],l="GET";if(k("reduce",c,g),k("include_docs",c,g),k("attachments",c,g),k("limit",c,g),k("descending",c,g),k("group",c,g),k("group_level",
c,g),k("skip",c,g),k("stale",c,g),k("conflicts",c,g),k("startkey",c,g,!0),k("start_key",c,g,!0),k("endkey",c,g,!0),k("end_key",c,g,!0),k("inclusive_end",c,g),k("key",c,g,!0),k("update_seq",c,g),g=""===(g=g.join("&"))?"":"?"+g,void 0!==c.keys){var m="keys="+encodeURIComponent(JSON.stringify(c.keys));2E3>=m.length+g.length+1?g+=("?"===g[0]?"&":"?")+m:(l="POST","string"==typeof b?d={keys:c.keys}:b.keys=c.keys)}return"string"==typeof b?(m=Ab(b),a.fetch("_design/"+m[0]+"/_view/"+m[1]+g,{headers:new Ba({"Content-Type":"application/json"}),
method:l,body:JSON.stringify(d)}).then(function(a){return e=a.ok,f=a.status,a.json()}).then(function(a){if(!e)throw a.status=f,ua(a);return a.rows.forEach(function(a){if(a.value&&a.value.error&&"builtin_reduce_error"===a.value.error)throw Error(a.reason);}),a}).then(h(c))):(d=d||{},Object.keys(b).forEach(function(a){Array.isArray(b[a])?d[a]=b[a]:d[a]=b[a].toString()}),a.fetch("_temp_view"+g,{headers:new Ba({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(d)}).then(function(a){return e=
a.ok,f=a.status,a.json()}).then(function(a){if(!e)throw a.status=f,ua(a);return a}).then(h(c)))}(b,c,e);if("string"!=typeof c)return m(e,c),Cc.add(function(){return vc(b,"temp_view/temp_view",c.map,c.reduce,!0,a).then(function(a){return b=q(a).then(function(){return v(a,e)}),c=function(){return a.db.destroy()},b.then(function(a){return c().then(function(){return a})},function(a){return c().then(function(){throw a;})});var b,c})}),Cc.finish();var n=Ab(c),p=n[1];return b.get("_design/"+n[0]).then(function(f){var g=
f.views&&f.views[p];if(!g)throw new Ua("ddoc "+f._id+" has no view named "+p);return d(f,p),m(e,g),vc(b,c,g.map,g.reduce,!1,a).then(function(a){return"ok"===e.stale||"update_after"===e.stale?("update_after"===e.stale&&ia(function(){q(a)}),v(a,e)):q(a).then(function(){return v(a,e)})})})}var y;return{query:function(a,b,c){var d,e=this;"function"==typeof b&&(c=b,b={});b=b?((d=b).group_level=l(d.group_level),d.limit=l(d.limit),d.skip=l(d.skip),d):{};"function"==typeof a&&(a={map:a});d=Promise.resolve().then(function(){return x(e,
a,b)});return qc(d,c),d},viewCleanup:(y=function(){var b,c;return"function"==typeof this._viewCleanup?(b=this,new Promise(function(a,c){b._viewCleanup(function(b,d){if(b)return c(b);a(d)})})):ea(this)?this.fetch("_view_cleanup",{headers:new Ba({"Content-Type":"application/json"}),method:"POST"}).then(function(a){return a.json()}):(c=this).get("_local/"+a).then(function(a){var b=new V;Object.keys(a.views).forEach(function(a){var c=Ab(a);a="_design/"+c[0];c=c[1];var d=b.get(a);d||(d=new za,b.set(a,
d));d.add(c)});var d={keys:yb(b),include_docs:!0};return c.allDocs(d).then(function(d){var e={};d.rows.forEach(function(c){var d=c.key.substring(8);b.get(c.key).forEach(function(b){var f=d+"/"+b;a.views[f]||(f=b);f=Object.keys(a.views[f]);var g=c.doc&&c.doc.views&&c.doc.views[b];f.forEach(function(a){e[a]=e[a]||g})})});d=Object.keys(e).filter(function(a){return!e[a]}).map(function(a){return xb(u(a),function(){return(new c.constructor(a,c.__opts)).destroy()})()});return Promise.all(d).then(function(){return{ok:!0}})})},
n({ok:!0}))},va(function(a){var b=a.pop();a=y.apply(this,a);return"function"==typeof b&&qc(a,b),a}))}}("mrviews",function(a,b){return"function"==typeof a&&2===a.length?function(c){return a(c,b)}:tc(a.toString(),b)},function(a){a=a.toString();if(/^_sum/.test(a))var b=xd;else if(/^_count/.test(a))b=yd;else if(/^_stats/.test(a))b=zd;else{if(/^_/.test(a))throw Error(a+" is not a supported reduce function.");b=void 0}return b||tc(a)},function(a,b){var c=a.views&&a.views[b];if("string"!=typeof c.map)throw new Ua("ddoc "+
a._id+" has no string view named "+b+", instead found object of type: "+typeof c.map);});Ja.prototype.writeCheckpoint=function(a,b){var c=this;return this.updateTarget(a,b).then(function(){return c.updateSource(a,b)})};Ja.prototype.updateTarget=function(a,b){return this.opts.writeTargetCheckpoint?Bb(this.target,this.id,a,b,this.returnValue):Promise.resolve(!0)};Ja.prototype.updateSource=function(a,b){if(this.opts.writeSourceCheckpoint){var c=this;return Bb(this.src,this.id,a,b,this.returnValue)["catch"](function(a){if(yc(a))return!(c.opts.writeSourceCheckpoint=
!1);throw a;})}return Promise.resolve(!0)};var Ec={undefined:function(a,b){return 0===S(a.last_seq,b.last_seq)?b.last_seq:0},1:function(a,b){return function(a,b){return a.session_id===b.session_id?{last_seq:a.last_seq,history:a.history}:function ja(a,b){var c=a[0],d=a.slice(1),e=b[0],f=b.slice(1);return c&&0!==b.length?Cb(c.session_id,b)?{last_seq:c.last_seq,history:a}:Cb(e.session_id,d)?{last_seq:e.last_seq,history:f}:ja(d,f):{last_seq:0,history:[]}}(a.history,b.history)}(b,a).last_seq}};Ja.prototype.getCheckpoint=
function(){var a=this;return a.opts&&a.opts.writeSourceCheckpoint&&!a.opts.writeTargetCheckpoint?a.src.get(a.id).then(function(a){return a.last_seq||0})["catch"](function(a){if(404!==a.status)throw a;return 0}):a.target.get(a.id).then(function(b){return a.opts&&a.opts.writeTargetCheckpoint&&!a.opts.writeSourceCheckpoint?b.last_seq||0:a.src.get(a.id).then(function(a){return b.version!==a.version?0:(c=b.version?b.version.toString():"undefined")in Ec?Ec[c](b,a):0;var c},function(c){if(404===c.status&&
b.last_seq)return a.src.put({_id:a.id,last_seq:0}).then(function(){return 0},function(c){return yc(c)?(a.opts.writeSourceCheckpoint=!1,b.last_seq):0});throw c;})})["catch"](function(a){if(404!==a.status)throw a;return 0})};da(Wa,W.EventEmitter);Wa.prototype.cancel=function(){this.cancelled=!0;this.state="cancelled";this.emit("cancel")};Wa.prototype.ready=function(a,b){function c(){d.cancel()}var d=this;d._readyCalled||(d._readyCalled=!0,a.once("destroyed",c),b.once("destroyed",c),d.once("complete",
function(){a.removeListener("destroyed",c);b.removeListener("destroyed",c)}))};da(Eb,W.EventEmitter);Eb.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};z.plugin(function(a){a.adapter("idb",nc,!0)}).plugin(function(a){a.adapter("http",vb,!1);a.adapter("https",vb,!1)}).plugin({query:function(a,b,c){return Dc.query.call(this,a,b,c)},viewCleanup:function(a){return Dc.viewCleanup.call(this,a)}}).plugin(function(a){a.replicate=Db;a.sync=ud;Object.defineProperty(a.prototype,
"replicate",{get:function(){var a=this;return void 0===this.replicateMethods&&(this.replicateMethods={from:function(b,d,e){return a.constructor.replicate(b,a,d,e)},to:function(b,d,e){return a.constructor.replicate(a,b,d,e)}}),this.replicateMethods}});a.prototype.sync=function(a,c,d){return this.constructor.sync(this,a,c,d)}});y.exports=z}).call(this,l(5),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,12:12,2:2,3:3,4:4,5:5,6:6,7:7}]},{},
[13])(13)});